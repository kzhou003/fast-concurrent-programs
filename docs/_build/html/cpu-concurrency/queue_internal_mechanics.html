

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Queue Internal Mechanics: Condition Variables &amp; Events &mdash; Triton GPU Programming Guide 1.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=f2a433a1"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="task_done() and Queue Explained: Counter &amp; Condition Variables" href="task_done_queue_explained.html" />
    <link rel="prev" title="Queue Explained: Thread-Safe Data Structure &amp; Locking" href="queue_explained.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Triton GPU Programming Guide
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">CPU Concurrency</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="key_concepts.html">Key Concepts in Concurrent Programming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="key_concepts.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="key_concepts.html#id1">Concurrency vs Parallelism</a><ul>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#concurrency">Concurrency</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#parallelism">Parallelism</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#visual-comparison">Visual Comparison</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="key_concepts.html#id2">Threading vs Multiprocessing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#threading-concurrent-futures-threadpoolexecutor">Threading (concurrent.futures.ThreadPoolExecutor)</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#multiprocessing-concurrent-futures-processpoolexecutor">Multiprocessing (concurrent.futures.ProcessPoolExecutor)</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#when-to-use-what">When to Use What</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="key_concepts.html#id3">The Global Interpreter Lock (GIL)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#what-is-the-gil">What is the GIL?</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#key-points">Key Points:</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#impact-on-performance">Impact on Performance:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="key_concepts.html#with-gil-threads-don-t-help-cpu-bound-tasks">With GIL, threads don’t help CPU-bound tasks:</a></li>
<li class="toctree-l1"><a class="reference internal" href="key_concepts.html#gil-is-released-during-i-o-so-threading-helps">GIL is released during I/O, so threading helps:</a><ul>
<li class="toctree-l2"><a class="reference internal" href="key_concepts.html#id4">Asyncio and Event Loops</a><ul>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#event-loop">Event Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#how-it-works-from-script-07">How It Works (from script 07):</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#event-loop-lifecycle">Event Loop Lifecycle:</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#modern-vs-old-patterns">Modern vs Old Patterns:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="key_concepts.html#id5">Coroutines</a><ul>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#what-are-coroutines">What are Coroutines?</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#defining-coroutines">Defining Coroutines:</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#key-features">Key Features:</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#example-from-script-08">Example from Script 08:</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#execution-flow">Execution Flow:</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#important-rules">Important Rules:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="key_concepts.html#id6">Tasks and Futures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#tasks">Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#task-characteristics">Task Characteristics:</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#example-from-script-09">Example from Script 09:</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#futures">Futures</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#waiting-for-multiple-tasks">Waiting for Multiple Tasks:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="key_concepts.html#id9">CPU-bound vs I/O-bound Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#cpu-bound-operations">CPU-bound Operations</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="key_concepts.html#use-processpoolexecutor-for-cpu-bound-tasks">Use ProcessPoolExecutor for CPU-bound tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="key_concepts.html#combine-approaches">Combine approaches:</a><ul>
<li class="toctree-l2"><a class="reference internal" href="key_concepts.html#id10">Python 3.12 Migration Changes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#time-measurement-time-clock-time-perf-counter">1. Time Measurement (<code class="docutils literal notranslate"><span class="pre">time.clock()</span></code> → <code class="docutils literal notranslate"><span class="pre">time.perf_counter()</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#coroutine-syntax-asyncio-coroutine-async-def">2. Coroutine Syntax (<code class="docutils literal notranslate"><span class="pre">&#64;asyncio.coroutine</span></code> → <code class="docutils literal notranslate"><span class="pre">async</span> <span class="pre">def</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#task-creation-asyncio-task-asyncio-create-task">3. Task Creation (<code class="docutils literal notranslate"><span class="pre">asyncio.Task()</span></code> → <code class="docutils literal notranslate"><span class="pre">asyncio.create_task()</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#event-loop-management">4. Event Loop Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#future-callbacks-callbacks-await">5. Future Callbacks (Callbacks → <code class="docutils literal notranslate"><span class="pre">await</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#blocking-calls-in-async-code">6. Blocking Calls in Async Code</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#string-formatting-f-strings">7. String Formatting (<code class="docutils literal notranslate"><span class="pre">%</span></code> → f-strings)</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#migration-checklist">Migration Checklist</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#compatibility">Compatibility</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="key_concepts.html#summary">Summary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#quick-reference-guide">Quick Reference Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#key-takeaways">Key Takeaways</a></li>
<li class="toctree-l3"><a class="reference internal" href="key_concepts.html#further-reading">Further Reading</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html">Hardware Parallelism: Cores, Hyperthreading, and GPUs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hardware_parallelism.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="hardware_parallelism.html#id1">Physical Cores vs Logical Cores</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#physical-cores">Physical Cores</a></li>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#logical-cores">Logical Cores</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#check-on-your-system">Check on your system</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hardware_parallelism.html#id2">What is Hyperthreading?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#the-concept">The Concept</a></li>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#how-it-works">How It Works</a></li>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#technical-implementation">Technical Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#performance-characteristics">Performance Characteristics</a></li>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#hyperthreading-limitations">Hyperthreading Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#checking-hyperthreading-status">Checking Hyperthreading Status</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#check-if-ht-is-enabled">Check if HT is enabled</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#or-check-cpu-info">Or check CPU info</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#id3">Logical cores</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#id4">Physical cores</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#if-logical-physical-ht-is-enabled">If logical &gt; physical, HT is enabled</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#platform-specific-physical-core-detection">Platform-specific physical core detection</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hardware_parallelism.html#id5">How Threading is Bounded by Physical Cores</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#the-fundamental-constraint">The Fundamental Constraint</a></li>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#why-more-threads-more-speed">Why More Threads ≠ More Speed</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#benchmark-computing-sum-of-squares">Benchmark: Computing sum of squares</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#results-on-4-core-cpu">Results on 4-core CPU:</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#worker-10-0s-baseline">1 worker:  10.0s  (baseline)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#workers-5-1s-1-96x-speedup">2 workers:  5.1s  (1.96x speedup) ✅</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#workers-2-6s-3-85x-speedup">4 workers:  2.6s  (3.85x speedup) ✅</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#workers-2-8s-3-57x-speedup-worse-than-4">8 workers:  2.8s  (3.57x speedup) ⚠️ (worse than 4!)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#workers-3-2s-3-13x-speedup-much-worse">16 workers: 3.2s  (3.13x speedup) ❌ (much worse!)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#best-practice">Best practice:</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#conservative-recommended-for-production">Conservative (recommended for production):</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#or-detect-actual-physical-cores">Or detect actual physical cores:</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#matrix-multiplication-cpu-intensive">Matrix multiplication (CPU-intensive)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#test-on-4-core-cpu">Test on 4-core CPU:</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#typical-output">Typical output:</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#workers-time-speedup-efficiency">Workers | Time  | Speedup | Efficiency</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#id10">——–|-------|———|————</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hardware_parallelism.html#id11">Why GPUs Excel at Parallel Computing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#cpu-vs-gpu-different-design-philosophies">CPU vs GPU: Different Design Philosophies</a></li>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#key-differences">Key Differences</a></li>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#simd-and-gpu-architecture">SIMD and GPU Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#why-gpus-excel-at-compute-intensive-tasks">Why GPUs Excel at Compute-Intensive Tasks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hardware_parallelism.html#massive-parallelism">1. Massive Parallelism</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#cpu-approach-4-cores">CPU approach (4 cores):</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#split-into-4-chunks-of-250-000-each">Split into 4 chunks of 250,000 each</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#each-core-processes-250-000-additions-sequentially">Each core processes 250,000 additions sequentially</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#gpu-approach-16-384-cores">GPU approach (16,384 cores):</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#split-into-16-384-chunks-of-61-each">Split into 16,384 chunks of ~61 each</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#each-core-processes-61-additions">Each core processes ~61 additions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hardware_parallelism.html#id12">CPU vs GPU Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#silicon-real-estate-comparison">Silicon Real Estate Comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#performance-comparison">Performance Comparison</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#generate-random-matrices">Generate random matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#cpu-numpy-with-optimized-blas">CPU (NumPy with optimized BLAS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#gpu-using-cupy-cuda-arrays">GPU (using CuPy - CUDA arrays)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#typical-results">Typical results:</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#cpu-time-0-850s-intel-i9-8-cores">CPU time: 0.850s (Intel i9, 8 cores)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#gpu-time-0-012s-nvidia-rtx-4090">GPU time: 0.012s (NVIDIA RTX 4090)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#speedup-70-8x">Speedup: 70.8x</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hardware_parallelism.html#id13">When to Use What</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#decision-matrix">Decision Matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#practical-guidelines">Practical Guidelines</a><ul>
<li class="toctree-l4"><a class="reference internal" href="hardware_parallelism.html#use-cpu-when">Use CPU When:</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware_parallelism.html#use-gpu-when">Use GPU When:</a></li>
<li class="toctree-l4"><a class="reference internal" href="hardware_parallelism.html#use-hyperthreading-when">Use Hyperthreading When:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hardware_parallelism.html#id14">Practical Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#example-1-image-processing">Example 1: Image Processing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#task-apply-gaussian-blur-to-100-images-4k-resolution">Task: Apply Gaussian blur to 100 images (4K resolution)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#approach-1-sequential-cpu-1-core">Approach 1: Sequential (CPU, 1 core)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#time-300-seconds">Time: ~300 seconds</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#approach-2-cpu-multiprocessing-4-physical-cores">Approach 2: CPU Multiprocessing (4 physical cores)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#time-80-seconds-3-75x-speedup">Time: ~80 seconds (3.75x speedup)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#approach-3-gpu-cuda">Approach 3: GPU (CUDA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#time-4-seconds-75x-speedup">Time: ~4 seconds (75x speedup!)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#task-estimate-using-monte-carlo-1-billion-points">Task: Estimate π using Monte Carlo (1 billion points)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#sequential-cpu">Sequential CPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#cpu-multiprocessing-4-cores">CPU Multiprocessing (4 cores)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#gpu-cuda">GPU (CUDA)</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#task-train-a-neural-network-on-mnist-dataset">Task: Train a neural network on MNIST dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#define-simple-network">Define simple network</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#cpu-training">CPU Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="hardware_parallelism.html#gpu-training">GPU Training</a><ul>
<li class="toctree-l2"><a class="reference internal" href="hardware_parallelism.html#summary">Summary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#core-principles">Core Principles</a></li>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#quick-reference">Quick Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="hardware_parallelism.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="threading_basics.html">Threading Basics: start() and join()</a><ul>
<li class="toctree-l2"><a class="reference internal" href="threading_basics.html#what-is-start">What is start()?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="threading_basics.html#key-points-about-start">Key Points About start()</a></li>
<li class="toctree-l3"><a class="reference internal" href="threading_basics.html#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="threading_basics.html#create-thread-object-doesn-t-start-yet">Create thread object (doesn’t start yet)</a></li>
<li class="toctree-l1"><a class="reference internal" href="threading_basics.html#call-start-to-actually-begin-execution">Call start() to actually begin execution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="threading_basics.html#what-is-join">What is join()?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="threading_basics.html#key-points-about-join">Key Points About join()</a></li>
<li class="toctree-l3"><a class="reference internal" href="threading_basics.html#id1">Example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="threading_basics.html#comparison-with-vs-without-join">Comparison: With vs Without join()</a><ul>
<li class="toctree-l3"><a class="reference internal" href="threading_basics.html#without-join-danger">WITHOUT join() - DANGER!</a></li>
<li class="toctree-l3"><a class="reference internal" href="threading_basics.html#with-join-correct">WITH join() - CORRECT!</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="threading_basics.html#thread-lifecycle-diagram">Thread Lifecycle Diagram</a></li>
<li class="toctree-l2"><a class="reference internal" href="threading_basics.html#typical-pattern-for-multiple-threads">Typical Pattern for Multiple Threads</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="threading_basics.html#step-1-create-all-threads">Step 1: Create all threads</a></li>
<li class="toctree-l1"><a class="reference internal" href="threading_basics.html#step-2-wait-for-all-to-finish">Step 2: Wait for all to finish</a><ul>
<li class="toctree-l2"><a class="reference internal" href="threading_basics.html#common-mistakes">Common Mistakes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="threading_basics.html#mistake-1-calling-the-function-directly-instead-of-start">Mistake 1: Calling the function directly instead of start()</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="threading_basics.html#wrong-runs-worker-in-main-thread">❌ WRONG - runs worker in MAIN thread</a></li>
<li class="toctree-l1"><a class="reference internal" href="threading_basics.html#correct-runs-worker-in-new-thread">✅ CORRECT - runs worker in NEW thread</a></li>
<li class="toctree-l1"><a class="reference internal" href="threading_basics.html#wrong-main-exits-before-worker-finishes">❌ WRONG - main exits before worker finishes</a></li>
<li class="toctree-l1"><a class="reference internal" href="threading_basics.html#correct-wait-for-worker-to-finish">✅ CORRECT - wait for worker to finish</a></li>
<li class="toctree-l1"><a class="reference internal" href="threading_basics.html#not-safe-race-condition">❌ NOT SAFE - race condition</a></li>
<li class="toctree-l1"><a class="reference internal" href="threading_basics.html#safe-use-lock">✅ SAFE - use lock</a><ul>
<li class="toctree-l2"><a class="reference internal" href="threading_basics.html#practical-example-web-scraper">Practical Example: Web Scraper</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="threading_basics.html#urls-to-fetch">URLs to fetch</a></li>
<li class="toctree-l1"><a class="reference internal" href="threading_basics.html#create-and-start-threads">Create and start threads</a></li>
<li class="toctree-l1"><a class="reference internal" href="threading_basics.html#wait-for-all-to-complete">Wait for all to complete</a><ul>
<li class="toctree-l2"><a class="reference internal" href="threading_basics.html#summary-table">Summary Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="threading_basics.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="asyncio_event_loop.html">Asyncio Event Loop</a><ul>
<li class="toctree-l2"><a class="reference internal" href="asyncio_event_loop.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_event_loop.html#file-location">File Location</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_event_loop.html#key-concepts">Key Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="asyncio_event_loop.html#id1">Asyncio Event Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_event_loop.html#async-await-pattern">Async/Await Pattern</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_event_loop.html#code-breakdown">Code Breakdown</a><ul>
<li class="toctree-l3"><a class="reference internal" href="asyncio_event_loop.html#task-functions">Task Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_event_loop.html#main-function">Main Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_event_loop.html#entry-point">Entry Point</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_event_loop.html#python-3-12-updates">Python 3.12 Updates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="asyncio_event_loop.html#changes-made">Changes Made</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_event_loop.html#execution-flow">Execution Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_event_loop.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_event_loop.html#output-example">Output Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_event_loop.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="asyncio_coroutine.html">Asyncio Coroutine - Finite State Machine</a><ul>
<li class="toctree-l2"><a class="reference internal" href="asyncio_coroutine.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_coroutine.html#file-location">File Location</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_coroutine.html#key-concepts">Key Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="asyncio_coroutine.html#finite-state-machine-fsm">Finite State Machine (FSM)</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_coroutine.html#coroutines">Coroutines</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_coroutine.html#state-transitions">State Transitions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_coroutine.html#code-breakdown">Code Breakdown</a><ul>
<li class="toctree-l3"><a class="reference internal" href="asyncio_coroutine.html#state-machine-structure">State Machine Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_coroutine.html#start-state">Start State</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_coroutine.html#intermediate-states-state-1-2-3">Intermediate States (State 1, 2, 3)</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_coroutine.html#end-state">End State</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_coroutine.html#python-3-12-updates">Python 3.12 Updates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="asyncio_coroutine.html#changes-made">Changes Made</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_coroutine.html#execution-flow-example">Execution Flow Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_coroutine.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_coroutine.html#output-example">Output Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_coroutine.html#key-takeaways">Key Takeaways</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_coroutine.html#use-cases">Use Cases</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="asyncio_and_futures.html">Asyncio and Futures</a><ul>
<li class="toctree-l2"><a class="reference internal" href="asyncio_and_futures.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_and_futures.html#file-location">File Location</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_and_futures.html#key-concepts">Key Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="asyncio_and_futures.html#command-line-arguments">Command-Line Arguments</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_and_futures.html#async-task-results">Async Task Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_and_futures.html#concurrent-computation">Concurrent Computation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_and_futures.html#code-breakdown">Code Breakdown</a><ul>
<li class="toctree-l3"><a class="reference internal" href="asyncio_and_futures.html#first-coroutine-sum-of-n-integers">First Coroutine - Sum of N Integers</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_and_futures.html#second-coroutine-factorial">Second Coroutine - Factorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_and_futures.html#main-function">Main Function</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_and_futures.html#python-3-12-updates">Python 3.12 Updates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="asyncio_and_futures.html#changes-made">Changes Made</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_and_futures.html#before-vs-after-comparison">Before vs After Comparison</a><ul>
<li class="toctree-l3"><a class="reference internal" href="asyncio_and_futures.html#old-pattern-deprecated">Old Pattern (Deprecated)</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_and_futures.html#new-pattern-modern">New Pattern (Modern)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_and_futures.html#execution-flow">Execution Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_and_futures.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_and_futures.html#examples">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="asyncio_and_futures.html#example-1">Example 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_and_futures.html#example-2">Example 2</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_and_futures.html#performance">Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_and_futures.html#key-takeaways">Key Takeaways</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_and_futures.html#modern-best-practices">Modern Best Practices</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_and_futures.html#when-to-use-this-pattern">When to Use This Pattern</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_and_futures.html#capturing-results">Capturing Results</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="asyncio_task_manipulation.html">Asyncio Task Manipulation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="asyncio_task_manipulation.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_task_manipulation.html#file-location">File Location</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_task_manipulation.html#key-concepts">Key Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="asyncio_task_manipulation.html#asyncio-tasks">Asyncio Tasks</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_task_manipulation.html#concurrent-execution">Concurrent Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_task_manipulation.html#asyncio-gather">asyncio.gather()</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_task_manipulation.html#code-breakdown">Code Breakdown</a><ul>
<li class="toctree-l3"><a class="reference internal" href="asyncio_task_manipulation.html#factorial-computation">Factorial Computation</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_task_manipulation.html#fibonacci-computation">Fibonacci Computation</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_task_manipulation.html#binomial-coefficient-computation">Binomial Coefficient Computation</a></li>
<li class="toctree-l3"><a class="reference internal" href="asyncio_task_manipulation.html#main-function">Main Function</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_task_manipulation.html#python-3-12-updates">Python 3.12 Updates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="asyncio_task_manipulation.html#changes-made">Changes Made</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_task_manipulation.html#execution-flow">Execution Flow</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_task_manipulation.html#concurrency-vs-parallelism">Concurrency vs Parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_task_manipulation.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_task_manipulation.html#output-example">Output Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_task_manipulation.html#performance">Performance</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_task_manipulation.html#key-takeaways">Key Takeaways</a></li>
<li class="toctree-l2"><a class="reference internal" href="asyncio_task_manipulation.html#when-to-use">When to Use</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="concurrent_futures_pooling.html">Concurrent Futures Pooling</a><ul>
<li class="toctree-l2"><a class="reference internal" href="concurrent_futures_pooling.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="concurrent_futures_pooling.html#file-location">File Location</a></li>
<li class="toctree-l2"><a class="reference internal" href="concurrent_futures_pooling.html#key-concepts">Key Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="concurrent_futures_pooling.html#executor-pattern">Executor Pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="concurrent_futures_pooling.html#execution-models">Execution Models</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="concurrent_futures_pooling.html#code-breakdown">Code Breakdown</a><ul>
<li class="toctree-l3"><a class="reference internal" href="concurrent_futures_pooling.html#cpu-intensive-task">CPU-Intensive Task</a></li>
<li class="toctree-l3"><a class="reference internal" href="concurrent_futures_pooling.html#evaluation-function">Evaluation Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="concurrent_futures_pooling.html#sequential-execution">Sequential Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="concurrent_futures_pooling.html#thread-pool-execution">Thread Pool Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="concurrent_futures_pooling.html#process-pool-execution">Process Pool Execution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="concurrent_futures_pooling.html#performance-expectations">Performance Expectations</a></li>
<li class="toctree-l2"><a class="reference internal" href="concurrent_futures_pooling.html#python-3-12-updates">Python 3.12 Updates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="concurrent_futures_pooling.html#changes-made">Changes Made</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="concurrent_futures_pooling.html#usage">Usage</a></li>
<li class="toctree-l2"><a class="reference internal" href="concurrent_futures_pooling.html#output-example">Output Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="concurrent_futures_pooling.html#when-to-use-each-approach">When to Use Each Approach</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html">Queue Explained: Thread-Safe Data Structure &amp; Locking</a><ul>
<li class="toctree-l2"><a class="reference internal" href="queue_explained.html#what-is-a-queue">What is a Queue?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="queue_explained.html#key-concept">Key Concept</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="queue_explained.html#how-queue-works-internally">How Queue Works Internally</a><ul>
<li class="toctree-l3"><a class="reference internal" href="queue_explained.html#internal-structure">Internal Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="queue_explained.html#automatic-locking">Automatic Locking</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="queue_explained.html#queue-operations">Queue Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="queue_explained.html#put-item"><code class="docutils literal notranslate"><span class="pre">put(item)</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="queue_explained.html#why-queue-is-best-practice">Why Queue is Best Practice</a><ul>
<li class="toctree-l3"><a class="reference internal" href="queue_explained.html#problem-with-manual-locks">Problem with Manual Locks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#problems">Problems:</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#easy-to-forget-lock-somewhere">1. Easy to forget lock somewhere</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#busy-waiting-wastes-cpu">2. Busy-waiting wastes CPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#no-synchronization-between-threads">3. No synchronization between threads</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#race-conditions-possible">4. Race conditions possible</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#benefits">Benefits:</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#synchronization-automatic">1. Synchronization automatic</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#no-busy-waiting">2. No busy-waiting</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#blocks-correctly-when-empty-full">3. Blocks correctly when empty/full</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#task-tracking-with-task-done">4. Task tracking with task_done()</a><ul>
<li class="toctree-l2"><a class="reference internal" href="queue_explained.html#queue-as-locking-mechanism">Queue as Locking Mechanism</a><ul>
<li class="toctree-l3"><a class="reference internal" href="queue_explained.html#how-queue-does-locking">How Queue Does Locking</a></li>
<li class="toctree-l3"><a class="reference internal" href="queue_explained.html#locking-benefits">Locking Benefits</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="queue_explained.html#the-code-explained-producer-consumer">The Code Explained: Producer-Consumer</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#create-queue">Create queue</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#create-threads">Create threads</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#start-all">Start all</a><ul>
<li class="toctree-l2"><a class="reference internal" href="queue_explained.html#queue-vs-lock-vs-semaphore-vs-rlock">Queue vs Lock vs Semaphore vs RLock</a></li>
<li class="toctree-l2"><a class="reference internal" href="queue_explained.html#queue-benefits-summary">Queue Benefits Summary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="queue_explained.html#thread-safe-data-structure">1. <strong>Thread-Safe Data Structure</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#without-queue-need-to-manage-locking">Without Queue - Need to manage locking</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#with-queue-automatic">With Queue - Automatic</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#without-queue-need-condition-variables">Without Queue - Need condition variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#with-queue-blocks-automatically">With Queue - Blocks automatically</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#bad-busy-wait-wastes-cpu">Bad - Busy-wait (wastes CPU)</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#good-queue-blocks-efficiently">Good - Queue blocks efficiently</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#process-items">Process items</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#multiple-producers">Multiple producers</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#multiple-consumers">Multiple consumers</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#all-safe-queue-handles-synchronization">All safe! Queue handles synchronization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="queue_explained.html#internal-queue-locking-mechanism">Internal Queue Locking Mechanism</a><ul>
<li class="toctree-l3"><a class="reference internal" href="queue_explained.html#step-by-step-what-happens-in-put">Step-by-Step: What Happens in <code class="docutils literal notranslate"><span class="pre">put()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#internally-in-queue">Internally in Queue:</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#acquire-mutex-lock">1. Acquire mutex (lock)</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#check-if-full">2. Check if full</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#notify-consumers">4. Notify consumers</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#release-mutex">5. Release mutex</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#id7">Internally in Queue:</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#id8">1. Acquire mutex (lock)</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#check-if-empty">2. Check if empty</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#notify-producers">4. Notify producers</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#id9">5. Release mutex</a><ul>
<li class="toctree-l2"><a class="reference internal" href="queue_explained.html#why-queue-is-safer-than-manual-locking">Why Queue is Safer Than Manual Locking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="queue_explained.html#mistake-1-forgetting-lock">Mistake 1: Forgetting Lock</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#wrong-no-lock-on-append">❌ WRONG - No lock on append</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#correct-queue-is-always-locked">✅ CORRECT - Queue is always locked</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#wrong-wastes-cpu">❌ WRONG - Wastes CPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#correct-queue-blocks-efficiently">✅ CORRECT - Queue blocks efficiently</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#wrong-check-and-pop-not-atomic">❌ WRONG - Check and pop not atomic</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#correct-queue-makes-check-and-pop-atomic">✅ CORRECT - Queue makes check and pop atomic</a><ul>
<li class="toctree-l2"><a class="reference internal" href="queue_explained.html#practical-example-work-queue">Practical Example: Work Queue</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#create-workers">Create workers</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#add-tasks">Add tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#wait-for-all-tasks-to-be-processed">Wait for all tasks to be processed</a></li>
<li class="toctree-l1"><a class="reference internal" href="queue_explained.html#stop-workers">Stop workers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="queue_explained.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Queue Internal Mechanics: Condition Variables &amp; Events</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-answer">The Answer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#queue-s-internal-structure">Queue’s Internal Structure</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#inside-the-queue-object">Inside the Queue object:</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id1">┌─────────────────────────────────────────┐</a></li>
<li class="toctree-l1"><a class="reference internal" href="#queue-internal-state">│ Queue Internal State                    │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id2">├─────────────────────────────────────────┤</a></li>
<li class="toctree-l1"><a class="reference internal" href="#mutex-lock">│ mutex: Lock()                           │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#protects-all-modifications">│   - Protects all modifications          │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id3">│                                         │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#not-empty-condition">│ not_empty: Condition()                  │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#signals-when-items-added">│   - Signals when items added            │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#consumers-wait-on-this">│   - Consumers wait on this              │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id4">│                                         │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#not-full-condition">│ not_full: Condition()                   │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#signals-when-items-removed">│   - Signals when items removed          │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#producers-wait-on-this">│   - Producers wait on this              │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id5">│                                         │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#items">│ items: []                               │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#actual-items-without-conditions">│   - Actual items (without conditions)   │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id6">│                                         │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#task-counter-0">│ task_counter: 0                         │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#tracks-unfinished-tasks">│   - Tracks unfinished tasks             │</a></li>
<li class="toctree-l1"><a class="reference internal" href="#id7">└─────────────────────────────────────────┘</a></li>
<li class="toctree-l1"><a class="reference internal" href="#when-you-put-an-item">When you put an item</a></li>
<li class="toctree-l1"><a class="reference internal" href="#inside-queue">Inside queue:</a></li>
<li class="toctree-l1"><a class="reference internal" href="#items-42-just-the-number-no-condition-attached">items = [42]  ← Just the number, no condition attached</a></li>
<li class="toctree-l1"><a class="reference internal" href="#not-empty-condition-wakes-up-consumers">not_empty condition wakes up consumers</a></li>
<li class="toctree-l1"><a class="reference internal" href="#not-full-condition-might-wake-up-producers">not_full condition might wake up producers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-conditions-work-in-queue">How Conditions Work in Queue</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#condition-variables-explained">Condition Variables Explained</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#put-what-actually-happens">put() - What Actually Happens</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#step-by-step-execution">Step-by-Step Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#timeline-put-with-condition-variable">Timeline: put() with Condition Variable</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#get-what-actually-happens">get() - What Actually Happens</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id8">Step-by-Step Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#timeline-get-with-condition-variable">Timeline: get() with Condition Variable</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#visual-no-condition-on-items">Visual: No Condition On Items</a></li>
<li class="toctree-l2"><a class="reference internal" href="#complete-put-and-get-timeline">Complete put() and get() Timeline</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#scenario-queue-with-maxsize-2-multiple-producers-consumers">Scenario: Queue with maxsize=2, multiple producers/consumers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#key-insight-conditions-are-on-queue-not-items">Key Insight: Conditions Are On Queue, Not Items</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-people-might-think-wrong">What People Might Think (WRONG):</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#wrong-mental-model">❌ WRONG MENTAL MODEL</a></li>
<li class="toctree-l1"><a class="reference internal" href="#correct-mental-model">✓ CORRECT MENTAL MODEL</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#why-queue-uses-shared-conditions">Why Queue Uses Shared Conditions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#instead-of-per-item-events">Instead of Per-Item Events</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#this-would-be-inefficient-if-items-had-events">❌ This would be inefficient (if items had events)</a></li>
<li class="toctree-l1"><a class="reference internal" href="#this-is-efficient-what-queue-actually-does">✓ This is efficient (what Queue actually does)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-conditions-work-the-mechanism">How Conditions Work: The Mechanism</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#not-empty-notify-what-it-does">not_empty.notify() - What It Does</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#when-put-is-called">When put() is called</a></li>
<li class="toctree-l1"><a class="reference internal" href="#inside-put">Inside put():</a></li>
<li class="toctree-l1"><a class="reference internal" href="#this-tells-the-condition-variable">This tells the condition variable:</a></li>
<li class="toctree-l1"><a class="reference internal" href="#someone-just-added-an-item">“Someone just added an item”</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#back-to-your-original-question">Back to Your Original Question</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#does-each-item-get-a-condition">“Does each item get a condition?”</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-flow">The Flow</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#real-code-example">Real Code Example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#what-queue-put-actually-does">What Queue.put() Actually Does</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html">task_done() and Queue Explained: Counter &amp; Condition Variables</a><ul>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#quick-answer">Quick Answer</a></li>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#the-problem-without-task-done">The Problem Without task_done()</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#without-task-done-can-t-track-completion">Without task_done() - Can’t Track Completion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#how-do-we-know-if-all-items-have-been-processed">How do we know if ALL items have been processed?</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#we-don-t-consumer-might-still-be-working">WE DON’T! Consumer might still be working!</a><ul>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#how-task-done-works">How task_done() Works</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#internal-counter-system">Internal Counter System</a></li>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#visual-timeline">Visual Timeline</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#what-task-done-actually-does">What task_done() Actually Does</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#code-simplified">Code (Simplified)</a></li>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#two-operations">Two Operations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#the-third-condition-variable-all-tasks-done">The Third Condition Variable: all_tasks*done</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#timeline-all-three-conditions">Timeline: All Three Conditions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#complete-picture-all-operations">Complete Picture: All Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#put">put()</a></li>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#get">get()</a></li>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#task-done">task_done()</a></li>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#join">join()</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#the-complete-flow-with-all-three-conditions">The Complete Flow with All Three Conditions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#scenario-1-producer-1-consumer">Scenario: 1 Producer, 1 Consumer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#detailed-breakdown-task-done-with-counter">Detailed Breakdown: task_done() with Counter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#step-1-put-increment-counter">Step 1: put() - Increment Counter</a></li>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#step-2-get-item-removed-counter-unchanged">Step 2: get() - Item Removed, Counter Unchanged</a></li>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#step-3-task-done-decrement-counter">Step 3: task_done() - Decrement Counter</a></li>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#step-4-join-wait-then-return">Step 4: join() - Wait, Then Return</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#the-counter-lifecycle">The Counter Lifecycle</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#diagram-tracking-one-task">Diagram: Tracking One Task</a></li>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#diagram-multiple-tasks">Diagram: Multiple Tasks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#key-insight-two-data-flows">Key Insight: Two Data Flows</a></li>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#why-both-counter-and-condition-variable">Why BOTH Counter AND Condition Variable?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#counter">Counter</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#tracks-how-many-items-haven-t-been-marked-done-yet">Tracks how many items haven’t been marked done yet</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#used-to-know-when-to-signal">Used to know WHEN to signal</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#checked-by-join">Checked by join()</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#efficiently-wakes-up-waiting-threads">Efficiently wakes up waiting threads</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#avoids-busy-waiting">Avoids busy-waiting</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#used-by-join-to-sleep-instead-of-spinning">Used by join() to sleep instead of spinning</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#wrong-wastes-cpu">WRONG - Wastes CPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#right-uses-condition-variable">RIGHT - Uses condition variable</a><ul>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#visual-counter-and-condition-together">Visual: Counter and Condition Together</a></li>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#complete-operation-table">Complete Operation Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#what-happens-without-task-done">What Happens WITHOUT task_done()</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#queue-join-without-task-done">Queue.join() Without task_done()</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#no-task-done-calls">NO task_done() calls!</a><ul>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#what-happens-with-task-done">What Happens WITH task_done()</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#queue-join-with-task-done">Queue.join() With task_done()</a></li>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#why-it-works">Why It Works</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#the-three-step-cycle">The Three-Step Cycle</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#step-1-put-item">Step 1: Put Item</a></li>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#step-2-get-and-process">Step 2: Get and Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#step-3-mark-done">Step 3: Mark Done</a></li>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#flow-diagram">Flow Diagram</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#real-example-work-queue-pattern">Real Example: Work Queue Pattern</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#without-task-done-problematic">Without task_done() - PROBLEMATIC</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#add-tasks">Add tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#start-worker">Start worker</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#main-thread-wants-to-know-when-all-work-is-done">Main thread wants to know when all work is done</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#send-poison-pill-to-stop-worker">Send poison pill to stop worker</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#id1">Add tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#id2">Start worker</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#main-thread-waits-for-all-work-to-be-done">Main thread waits for all work to be done</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#id3">Send poison pill to stop worker</a><ul>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#why-is-this-useful">Why Is This Useful?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#use-case-1-verify-all-work-complete">Use Case 1: Verify All Work Complete</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#main-thread">Main thread</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#wait-for-workers-to-finish-all-tasks">Wait for workers to finish ALL tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#now-we-know-all-work-is-done">NOW we know all work is done</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#wait-for-completion">Wait for completion</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#main">Main</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#wait-until-all-batches-processed">Wait until all batches processed</a><ul>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#comparison-with-vs-without-task-done">Comparison: With vs Without task_done()</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#scenario-main-thread-needs-to-know-when-workers-finish">Scenario: Main thread needs to know when workers finish</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#the-flow-in-your-code-05-queue-py">The Flow in Your Code (05*queue.py)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#timeline">Timeline</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#the-missing-piece-in-the-code">The Missing Piece in the Code</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#better-code-pattern">Better Code Pattern</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#in-main">In main</a></li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#stop-consumers">Stop consumers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#summary-what-task-done-does">Summary: What task_done() Does</a><ul>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#why-we-need-task-done">Why We Need task_done()</a></li>
<li class="toctree-l3"><a class="reference internal" href="task_done_queue_explained.html#the-pattern">The Pattern</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="task_done_queue_explained.html#real-code-example">Real Code Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="task_done_queue_explained.html#now-wait-for-consumer-to-finish-processing-all-items">Now wait for consumer to finish processing ALL items</a></li>
<li class="toctree-l1"><a class="reference internal" href="rlock_explained.html">RLock (Reentrant Lock) Explained</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rlock_explained.html#what-is-rlock">What is RLock?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="rlock_explained.html#regular-lock-vs-rlock">Regular Lock vs RLock</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rlock_explained.html#how-rlock-works-internally">How RLock Works Internally</a></li>
<li class="toctree-l2"><a class="reference internal" href="rlock_explained.html#the-code-explained">The Code Explained</a><ul>
<li class="toctree-l3"><a class="reference internal" href="rlock_explained.html#why-rlock-is-needed-here">Why RLock is Needed Here</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rlock_explained.html#with-regular-lock-deadlock">With regular Lock - DEADLOCK!</a></li>
<li class="toctree-l1"><a class="reference internal" href="rlock_explained.html#with-rlock-no-deadlock">With RLock - NO DEADLOCK!</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rlock_explained.html#when-to-use-rlock-vs-regular-lock">When to Use RLock vs Regular Lock</a><ul>
<li class="toctree-l3"><a class="reference internal" href="rlock_explained.html#use-regular-lock-when">Use Regular Lock When:</a></li>
<li class="toctree-l3"><a class="reference internal" href="rlock_explained.html#use-rlock-when">Use RLock When:</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rlock_explained.html#execution-flow-of-the-code">Execution Flow of the Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="rlock_explained.html#reentrant-lock-counter-animation">Reentrant Lock Counter Animation</a></li>
<li class="toctree-l2"><a class="reference internal" href="rlock_explained.html#code-flow-with-comments">Code Flow with Comments</a></li>
<li class="toctree-l2"><a class="reference internal" href="rlock_explained.html#visual-comparison">Visual Comparison</a><ul>
<li class="toctree-l3"><a class="reference internal" href="rlock_explained.html#regular-lock-would-deadlock">Regular Lock - Would Deadlock</a></li>
<li class="toctree-l3"><a class="reference internal" href="rlock_explained.html#rlock-no-deadlock">RLock - No Deadlock</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rlock_explained.html#real-world-example">Real-World Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rlock_explained.html#without-rlock">Without RLock:</a></li>
<li class="toctree-l1"><a class="reference internal" href="rlock_explained.html#transfer-acquires-self-lock">transfer() acquires self.lock</a></li>
<li class="toctree-l1"><a class="reference internal" href="rlock_explained.html#withdraw-tries-to-acquire-self-lock-again">withdraw() tries to acquire self.lock again</a></li>
<li class="toctree-l1"><a class="reference internal" href="rlock_explained.html#deadlock">DEADLOCK!</a></li>
<li class="toctree-l1"><a class="reference internal" href="rlock_explained.html#with-rlock">With RLock:</a></li>
<li class="toctree-l1"><a class="reference internal" href="rlock_explained.html#transfer-acquires-self-lock-count-1">transfer() acquires self.lock (count=1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="rlock_explained.html#withdraw-acquires-self-lock-count-2-allowed">withdraw() acquires self.lock (count=2) - allowed!</a></li>
<li class="toctree-l1"><a class="reference internal" href="rlock_explained.html#no-deadlock">No deadlock!</a><ul>
<li class="toctree-l2"><a class="reference internal" href="rlock_explained.html#summary-table">Summary Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="rlock_explained.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html">Semaphore Explained</a><ul>
<li class="toctree-l2"><a class="reference internal" href="semaphore_explained.html#what-is-a-semaphore">What is a Semaphore?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="semaphore_explained.html#key-concept">Key Concept</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="semaphore_explained.html#two-types-of-semaphores">Two Types of Semaphores</a><ul>
<li class="toctree-l3"><a class="reference internal" href="semaphore_explained.html#counting-semaphore-counter-1">1. Counting Semaphore (Counter &gt; 1)</a></li>
<li class="toctree-l3"><a class="reference internal" href="semaphore_explained.html#binary-semaphore-counter-0-or-1">2. Binary Semaphore (Counter = 0 or 1)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="semaphore_explained.html#the-code-explained-producer-consumer-pattern">The Code Explained: Producer-Consumer Pattern</a><ul>
<li class="toctree-l3"><a class="reference internal" href="semaphore_explained.html#execution-timeline">Execution Timeline</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="semaphore_explained.html#semaphore-operations">Semaphore Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="semaphore_explained.html#acquire"><code class="docutils literal notranslate"><span class="pre">acquire()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="semaphore_explained.html#visual-representation">Visual Representation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="semaphore_explained.html#counting-semaphore-3-spots-available">Counting Semaphore (3 spots available)</a></li>
<li class="toctree-l3"><a class="reference internal" href="semaphore_explained.html#binary-semaphore-producer-consumer">Binary Semaphore (Producer-Consumer)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="semaphore_explained.html#semaphore-vs-lock">Semaphore vs Lock</a></li>
<li class="toctree-l2"><a class="reference internal" href="semaphore_explained.html#real-world-examples">Real-World Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="semaphore_explained.html#example-1-swimming-pool-with-limited-capacity">Example 1: Swimming Pool with Limited Capacity</a></li>
<li class="toctree-l3"><a class="reference internal" href="semaphore_explained.html#example-2-producer-consumer-like-the-code">Example 2: Producer-Consumer (Like the Code)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="semaphore_explained.html#how-the-code-works-step-by-step">How the Code Works Step by Step</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#initial-state">Initial state</a></li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#consumer-thread-starts">Consumer thread starts</a></li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#producer-thread-starts-10-times-in-the-loop">Producer thread starts (10 times in the loop)</a></li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#id1">Execution timeline:</a></li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#time-0-consumer-starts-calls-acquire-blocks-counter-0">Time 0:   consumer() starts, calls acquire(), blocks (counter=0)</a></li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#time-0-producer-starts-sleeps-for-3-seconds">Time 0:   producer() starts, sleeps for 3 seconds</a></li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#time-3-producer-wakes-up-generates-item">Time 3:   producer() wakes up, generates item</a></li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#time-3-producer-calls-release-counter-becomes-1">Time 3:   producer() calls release() - counter becomes 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#time-3-consumer-wakes-up-from-acquire-can-continue">Time 3:   consumer() wakes up from acquire(), can continue</a></li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#time-3-consumer-prints-the-item">Time 3:   consumer() prints the item</a></li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#time-3-both-threads-finish-join-completes">Time 3:   both threads finish (join completes)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="semaphore_explained.html#semaphore-states-and-transitions">Semaphore States and Transitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="semaphore_explained.html#counting-semaphore-states">Counting Semaphore States</a></li>
<li class="toctree-l2"><a class="reference internal" href="semaphore_explained.html#common-use-cases">Common Use Cases</a><ul>
<li class="toctree-l3"><a class="reference internal" href="semaphore_explained.html#limiting-concurrent-access">1. <strong>Limiting Concurrent Access</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#only-5-threads-can-access-database-at-once">Only 5 threads can access database at once</a></li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#sender-signals-receiver">Sender signals receiver</a></li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#wait-for-all-workers-to-finish">Wait for all workers to finish</a></li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#main-waits-for-all">Main waits for all</a><ul>
<li class="toctree-l2"><a class="reference internal" href="semaphore_explained.html#key-differences-from-lock">Key Differences from Lock</a><ul>
<li class="toctree-l3"><a class="reference internal" href="semaphore_explained.html#lock-threading-lock">Lock (<code class="docutils literal notranslate"><span class="pre">threading.Lock</span></code>)</a></li>
<li class="toctree-l3"><a class="reference internal" href="semaphore_explained.html#semaphore-counting">Semaphore (Counting)</a></li>
<li class="toctree-l3"><a class="reference internal" href="semaphore_explained.html#semaphore-binary-used-as-signal">Semaphore (Binary - Used as Signal)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#thread-a-waits-for-signal">Thread A waits for signal</a></li>
<li class="toctree-l1"><a class="reference internal" href="semaphore_explained.html#thread-b-sends-signal">Thread B sends signal</a><ul>
<li class="toctree-l2"><a class="reference internal" href="semaphore_explained.html#summary-table">Summary Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="semaphore_explained.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html">Why Different Approaches for CPU-bound vs I/O-bound Problems?</a><ul>
<li class="toctree-l2"><a class="reference internal" href="patterns_problems_mapping.html#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="patterns_problems_mapping.html#id1">The Fundamental Problem: The GIL</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#what-is-the-gil">What is the GIL?</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#why-does-python-have-a-gil">Why Does Python Have a GIL?</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#how-the-gil-works">How the GIL Works</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#conceptual-representation-of-gil-behavior">Conceptual representation of GIL behavior</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#cpu-bound-operation">CPU-bound operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#thread-1-acquires-gil-executes-releases-after-100-bytecodes-repeat">Thread 1 acquires GIL → executes → releases after ~100 bytecodes → repeat</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#thread-2-waits-acquires-gil-executes-releases-repeat">Thread 2 waits → acquires GIL → executes → releases → repeat</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#result-threads-take-turns-no-parallel-execution">Result: Threads take TURNS, no parallel execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#i-o-bound-operation">I/O-bound operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#thread-1-acquires-gil-starts-i-o-releases-gil-during-i-o-wait">Thread 1 acquires GIL → starts I/O → RELEASES GIL during I/O wait</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#thread-2-can-now-acquire-gil-and-execute-while-thread-1-waits">Thread 2 can now acquire GIL and execute while Thread 1 waits</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#result-threads-can-work-while-others-are-waiting-for-i-o">Result: Threads can work while others are waiting for I/O</a><ul>
<li class="toctree-l2"><a class="reference internal" href="patterns_problems_mapping.html#id2">How CPU and I/O Operations Differ</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#cpu-bound-operations">CPU-bound Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#i-o-bound-operations">I/O-bound Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#real-world-analogy">Real-World Analogy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns_problems_mapping.html#id3">Why Multiprocessing for CPU-bound</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#the-problem-with-threading-for-cpu-bound">The Problem with Threading for CPU-bound</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#cpu-intensive-task-with-threading">CPU-intensive task with threading</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#sequential">Sequential</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#threading-same-time-or-worse">Threading (SAME TIME OR WORSE!)</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#cpu-intensive-task-with-multiprocessing">CPU-intensive task with multiprocessing</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#multiprocessing">Multiprocessing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="patterns_problems_mapping.html#id4">Why Threading for I/O-bound</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#the-problem-wasted-time">The Problem: Wasted Time</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#sequential-i-o-operations">Sequential I/O operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#threaded-i-o-operations">Threaded I/O operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#what-happens-under-the-hood">What happens under the hood:</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#real-example-downloading-10-web-pages">Real example: Downloading 10 web pages</a><ul>
<li class="toctree-l2"><a class="reference internal" href="patterns_problems_mapping.html#id5">Why Asyncio for I/O-bound</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#the-problem-with-threading-overhead">The Problem with Threading: Overhead</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#asyncio-cooperative-multitasking">Asyncio: Cooperative Multitasking</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#how-asyncio-works">How Asyncio Works</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#asyncio-example-10-000-concurrent-requests">Asyncio example: 10,000 concurrent requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#threading-approach">Threading approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#problem-creating-1000-threads">Problem: Creating 1000 threads!</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#memory-8-gb-1000-8-mb-stack-per-thread">Memory: ~8 GB (1000 × 8 MB stack per thread)</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#os-overhead-managing-1000-threads">OS overhead: Managing 1000 threads</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#asyncio-approach">Asyncio approach</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#solution-single-thread-1000-lightweight-tasks">Solution: Single thread, 1000 lightweight tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#memory-50-mb-total">Memory: ~50 MB total</a></li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#os-overhead-none-all-managed-by-python">OS overhead: None (all managed by Python)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="patterns_problems_mapping.html#id10">Deep Dive: What Happens Under the Hood</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#cpu-bound-with-threading-the-gil-dance">CPU-bound with Threading: The GIL Dance</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#example-two-threads-computing-sum">Example: Two threads computing sum</a><ul>
<li class="toctree-l2"><a class="reference internal" href="patterns_problems_mapping.html#id11">Performance Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#benchmark-cpu-bound-task-computing">Benchmark: CPU-bound Task (Computing π)</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#benchmark-i-o-bound-task-web-requests">Benchmark: I/O-bound Task (Web Requests)</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#benchmark-mixed-workload">Benchmark: Mixed Workload</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns_problems_mapping.html#id14">Decision Tree</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#quick-reference-table">Quick Reference Table</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#code-templates">Code Templates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="patterns_problems_mapping.html#summary-the-core-principles">Summary: The Core Principles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#the-gil-controls-everything">1. The GIL Controls Everything</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#resource-usage-matters">2. Resource Usage Matters</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#trade-offs-are-real">3. Trade-offs are Real</a></li>
<li class="toctree-l3"><a class="reference internal" href="patterns_problems_mapping.html#know-your-workload">4. Know Your Workload</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="patterns_problems_mapping.html#profile-your-code-first">Profile your code first!</a><ul>
<li class="toctree-l2"><a class="reference internal" href="patterns_problems_mapping.html#final-thoughts">Final Thoughts</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GPU Concepts &amp; Fundamentals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gpu-concepts/gpu-fundamentals.html">GPU Fundamentals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/gpu-fundamentals.html#understanding-gpu-architecture">Understanding GPU Architecture</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/gpu-fundamentals.html#key-differences-cpu-vs-gpu">Key Differences: CPU vs GPU</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/gpu-fundamentals.html#gpu-hierarchy">GPU Hierarchy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/gpu-fundamentals.html#streaming-multiprocessors-sms">Streaming Multiprocessors (SMs)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/gpu-fundamentals.html#thread-organization">Thread Organization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/gpu-fundamentals.html#spmd-programming-model">SPMD Programming Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/gpu-fundamentals.html#example-visualization">Example Visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/gpu-fundamentals.html#compute-capabilities">Compute Capabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/gpu-fundamentals.html#key-concepts-summary">Key Concepts Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/gpu-fundamentals.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html">GPU Memory Hierarchy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#the-performance-pyramid">The Performance Pyramid</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#global-memory-hbm-dram">Global Memory (HBM/DRAM)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#memory-coalescing">Memory Coalescing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#l2-cache">L2 Cache</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#l1-cache-shared-memory-sram">L1 Cache / Shared Memory (SRAM)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#example-matrix-multiplication">Example: Matrix Multiplication</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#registers">Registers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#memory-access-patterns">Memory Access Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#pattern-1-streaming-bandwidth-bound">Pattern 1: Streaming (Bandwidth-Bound)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#pattern-2-staged-computation-compute-bound">Pattern 2: Staged Computation (Compute-Bound)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#pattern-3-reduction-mixed">Pattern 3: Reduction (Mixed)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#optimizing-for-memory-hierarchy">Optimizing for Memory Hierarchy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#the-golden-rules">The Golden Rules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#example-naive-vs-optimized-softmax">Example: Naive vs Optimized Softmax</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#measuring-memory-performance">Measuring Memory Performance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#key-metrics">Key Metrics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#tools-for-profiling">Tools for Profiling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/memory-hierarchy.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-concepts/execution-model.html">GPU Execution Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/execution-model.html#thread-execution">Thread Execution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#warps-and-simd-execution">Warps and SIMD Execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#thread-divergence">Thread Divergence</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/execution-model.html#occupancy">Occupancy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#what-is-occupancy">What is Occupancy?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#factors-limiting-occupancy">Factors Limiting Occupancy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#example-calculation">Example Calculation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/execution-model.html#latency-hiding">Latency Hiding</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#why-occupancy-matters">Why Occupancy Matters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#the-occupancy-sweet-spot">The Occupancy Sweet Spot</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/execution-model.html#kernel-launch-configuration">Kernel Launch Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#grid-and-block-dimensions">Grid and Block Dimensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#choosing-block-size">Choosing Block Size</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/execution-model.html#synchronization">Synchronization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#within-a-block">Within a Block</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#between-blocks">Between Blocks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/execution-model.html#warp-level-operations">Warp-Level Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#warp-shuffles">Warp Shuffles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#warp-level-reductions">Warp-Level Reductions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/execution-model.html#software-pipelining">Software Pipelining</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#overlap-compute-and-memory">Overlap Compute and Memory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/execution-model.html#persistent-kernels">Persistent Kernels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#traditional-approach">Traditional Approach</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#persistent-approach">Persistent Approach</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/execution-model.html#performance-considerations">Performance Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#key-factors">Key Factors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/execution-model.html#profiling-tools">Profiling Tools</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/execution-model.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-concepts/performance-optimization.html">Performance Optimization Strategies</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#the-optimization-process">The Optimization Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#step-1-profile-first">Step 1: Profile First</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#step-2-identify-bottleneck">Step 2: Identify Bottleneck</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#memory-optimization">Memory Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#strategy-1-kernel-fusion">Strategy 1: Kernel Fusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#strategy-2-tiling">Strategy 2: Tiling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#strategy-3-vectorized-loads">Strategy 3: Vectorized Loads</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#strategy-4-memory-coalescing">Strategy 4: Memory Coalescing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#compute-optimization">Compute Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#strategy-1-use-tensor-cores">Strategy 1: Use Tensor Cores</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#strategy-2-increase-arithmetic-intensity">Strategy 2: Increase Arithmetic Intensity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#strategy-3-minimize-thread-divergence">Strategy 3: Minimize Thread Divergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#strategy-4-optimize-loop-structure">Strategy 4: Optimize Loop Structure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#occupancy-optimization">Occupancy Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#strategy-1-reduce-register-usage">Strategy 1: Reduce Register Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#strategy-2-tune-shared-memory">Strategy 2: Tune Shared Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#strategy-3-adjust-block-size">Strategy 3: Adjust Block Size</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#auto-tuning">Auto-Tuning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#why-auto-tune">Why Auto-Tune?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#triton-auto-tuning">Triton Auto-Tuning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#advanced-techniques">Advanced Techniques</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#warp-specialization">Warp Specialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#persistent-kernels">Persistent Kernels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#recomputation">Recomputation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#common-patterns">Common Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#pattern-reduction">Pattern: Reduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#pattern-element-wise">Pattern: Element-wise</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#pattern-matrix-multiply">Pattern: Matrix Multiply</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#debugging-performance-issues">Debugging Performance Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#issue-low-bandwidth">Issue: Low Bandwidth</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#issue-low-compute-utilization">Issue: Low Compute Utilization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#issue-lower-than-pytorch">Issue: Lower Than PyTorch</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#performance-checklist">Performance Checklist</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#before-you-optimize">Before You Optimize</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#memory-optimizations">Memory Optimizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#compute-optimizations">Compute Optimizations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#id1">Occupancy Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#advanced">Advanced</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-concepts/performance-optimization.html#next-steps">Next Steps</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GPU Tutorials - Beginner Level</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html">Vector Addition in Triton</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#what-you-ll-learn">What You’ll Learn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#gpu-cuda-concepts">GPU/CUDA Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#spmd-single-program-multiple-data">SPMD (Single Program, Multiple Data)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#program-id-and-block-processing">Program ID and Block Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#grid-size">Grid Size</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#memory-hierarchy">Memory Hierarchy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#memory-coalescing">Memory Coalescing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#masking-for-boundary-conditions">Masking for Boundary Conditions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#how-the-kernel-works">How the Kernel Works</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#step-by-step-execution">Step-by-Step Execution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#performance-characteristics">Performance Characteristics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#bandwidth-bound-operation">Bandwidth-Bound Operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#arithmetic-intensity">Arithmetic Intensity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#theoretical-performance">Theoretical Performance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#triton-specific-features">Triton-Specific Features</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#triton-jit-decorator"><code class="docutils literal notranslate"><span class="pre">&#64;triton.jit</span></code> Decorator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#constexpr-for-compile-time-constants"><code class="docutils literal notranslate"><span class="pre">constexpr</span></code> for Compile-Time Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#launch-grid-syntax">Launch Grid Syntax</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#benchmarking-insights">Benchmarking Insights</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#expected-results">Expected Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#common-patterns-you-ll-see">Common Patterns You’ll See</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#pointer-arithmetic">1. Pointer Arithmetic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#vectorized-operations">2. Vectorized Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#masked-memory-operations">3. Masked Memory Operations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#key-takeaways">Key Takeaways</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#comparison-to-cuda">Comparison to CUDA</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/01-vector-add.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html">Fused Softmax in Triton</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#what-you-ll-learn">What You’ll Learn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#the-problem-with-naive-softmax">The Problem with Naive Softmax</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#standard-softmax-formula">Standard Softmax Formula</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#naive-pytorch-implementation">Naive PyTorch Implementation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#gpu-memory-hierarchy">GPU Memory Hierarchy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#dram-global-memory">DRAM (Global Memory)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#sram-shared-memory-l1-cache">SRAM (Shared Memory / L1 Cache)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#the-key-insight">The Key Insight</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#how-the-fused-kernel-works">How the Fused Kernel Works</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#block-level-processing">Block-Level Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#step-1-load-row-into-sram">Step 1: Load Row Into SRAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#step-2-compute-max-reduction">Step 2: Compute Max (Reduction)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#step-3-exponentiation">Step 3: Exponentiation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#step-4-compute-sum-another-reduction">Step 4: Compute Sum (Another Reduction)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#step-5-normalize-and-write-back">Step 5: Normalize and Write Back</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#power-of-two-block-sizes">Power-of-Two Block Sizes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#why-must-block-size-be-power-of-2">Why Must BLOCK_SIZE Be Power of 2?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#occupancy-and-performance-tuning">Occupancy and Performance Tuning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#number-of-warps">Number of Warps</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#number-of-pipeline-stages">Number of Pipeline Stages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#computing-occupancy">Computing Occupancy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#persistent-kernels">Persistent Kernels</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#the-pattern">The Pattern</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#numerical-stability">Numerical Stability</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#why-subtract-max">Why Subtract Max?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#padding-with-inf">Padding with -inf</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#memory-bandwidth-analysis">Memory Bandwidth Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#theoretical-speedup">Theoretical Speedup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#actual-performance">Actual Performance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#key-cuda-triton-concepts">Key CUDA/Triton Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#reduction-operations">Reduction Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#warp-shuffles">Warp Shuffles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#block-vs-thread">Block vs Thread</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#common-pitfalls">Common Pitfalls</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#row-too-large-for-sram">1. Row Too Large for SRAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#numerical-precision">2. Numerical Precision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#masking-errors">3. Masking Errors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#performance-tips">Performance Tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#comparison-to-other-approaches">Comparison to Other Approaches</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#jit-fusion-torch-jit-script">JIT Fusion (torch.jit.script)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#manual-cuda">Manual CUDA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#cudnn-cublas">CuDNN/CuBLAS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#extensions">Extensions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/02-fused-softmax.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GPU Tutorials - Intermediate Level</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html">Matrix Multiplication in Triton</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#what-you-ll-learn">What You’ll Learn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#the-matrix-multiplication-problem">The Matrix Multiplication Problem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#basic-algorithm">Basic Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#why-it-s-hard-to-optimize">Why It’s Hard to Optimize</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#gpu-matrix-multiplication-strategy">GPU Matrix Multiplication Strategy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#blocked-algorithm">Blocked Algorithm</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#pseudocode-for-our-kernel">Pseudocode for our kernel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#pointer-arithmetic-in-2d">Pointer Arithmetic in 2D</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#understanding-strides">Understanding Strides</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#block-pointers">Block Pointers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#broadcasting-multiplication">Broadcasting multiplication:</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#l2-cache-optimization">L2 Cache Optimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#the-problem-with-row-major-ordering">The Problem with Row-Major Ordering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#grouped-ordering-swizzling">Grouped Ordering (Swizzling)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#auto-tuning">Auto-Tuning</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#the-configuration-space">The Configuration Space</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#triton-s-auto-tuner">Triton’s Auto-Tuner</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#id3">)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#good-configurations">Good Configurations</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#the-kernel-implementation">The Kernel Implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#step-1-compute-program-ids">Step 1: Compute Program IDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#step-2-initialize-pointers">Step 2: Initialize Pointers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#step-3-accumulation-loop">Step 3: Accumulation Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#step-4-apply-activation-optional">Step 4: Apply Activation (Optional)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#step-5-store-result">Step 5: Store Result</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#tensor-cores">Tensor Cores</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#what-are-tensor-cores">What Are Tensor Cores?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#how-tensor-cores-work">How Tensor Cores Work</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#triton-and-tensor-cores">Triton and Tensor Cores</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#performance-analysis">Performance Analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#arithmetic-intensity">Arithmetic Intensity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#roofline-model">Roofline Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#expected-performance">Expected Performance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#advanced-optimizations">Advanced Optimizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#software-pipelining">Software Pipelining</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#loop-unrolling">Loop Unrolling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#register-pressure">Register Pressure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#common-pitfalls">Common Pitfalls</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#non-contiguous-tensors">1. Non-Contiguous Tensors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#wrong-stride-calculation">2. Wrong Stride Calculation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#boundary-conditions">3. Boundary Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#numerical-precision">4. Numerical Precision</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#benchmarking-tips">Benchmarking Tips</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#warm-up">1. Warm-up</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#measure-tflops">2. Measure TFLOPS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#compare-against-cublas-rocblas">3. Compare Against cuBLAS/rocBLAS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#test-different-sizes">4. Test Different Sizes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/03-matrix-multiplication.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html">Low-Memory Dropout in Triton</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#what-you-ll-learn">What You’ll Learn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#what-is-dropout">What is Dropout?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#purpose">Purpose</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#mathematical-definition">Mathematical Definition</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#id1">}</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#scaling-factor">Scaling Factor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#naive-implementation-problems">Naive Implementation Problems</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#standard-pytorch-dropout">Standard PyTorch Dropout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#the-backward-pass-problem">The Backward Pass Problem</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#forward">Forward</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#backward-later">Backward (later)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#backward-pass-uses-different-mask-wrong-gradients">Backward pass uses different mask → wrong gradients!</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#seeded-dropout-solution">Seeded Dropout Solution</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#key-insight">Key Insight</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#the-triton-implementation">The Triton Implementation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#parallel-random-number-generation">Parallel Random Number Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#the-challenge">The Challenge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#the-solution-counter-based-prng">The Solution: Counter-Based PRNG</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#the-philox-algorithm">The Philox Algorithm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#using-philox-in-triton">Using Philox in Triton</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#call-again-with-same-seed-and-offsets">Call again with same seed and offsets:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#different-seed">Different seed:</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#memory-and-performance-trade-offs">Memory and Performance Trade-offs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#memory-comparison">Memory Comparison</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#computational-cost">Computational Cost</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#when-to-use-seeded-dropout">When to Use Seeded Dropout</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#reproducibility-and-determinism">Reproducibility and Determinism</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#ensuring-same-random-numbers">Ensuring Same Random Numbers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#forward-pass">Forward pass</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#backward-pass-later">Backward pass (later)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#must-use-same-seed-to-get-same-mask">Must use SAME seed to get SAME mask</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#implementation-details">Implementation Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#the-tl-where-function">The <code class="docutils literal notranslate"><span class="pre">tl.where</span></code> Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#masking-for-boundary-conditions">Masking for Boundary Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#random-number-distribution">Random Number Distribution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#advanced-considerations">Advanced Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#different-random-distributions">Different Random Distributions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#generate-normal-distribution">Generate normal distribution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#performance-benchmarks">Performance Benchmarks</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#expected-performance">Expected Performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#bottleneck-analysis">Bottleneck Analysis</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#practical-usage">Practical Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#integration-with-pytorch">Integration with PyTorch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#seed-generation-strategies">Seed Generation Strategies</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#ensure-different-seeds-on-different-gpus">Ensure different seeds on different GPUs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/04-low-memory-dropout.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GPU Tutorials - Advanced Level</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html">Layer Normalization in Triton</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#what-you-ll-learn">What You’ll Learn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#what-is-layer-normalization">What is Layer Normalization?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#the-formula">The Formula</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#step-by-step-math">Step-by-Step Math</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#why-layer-normalization">Why Layer Normalization?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#batch-norm-vs-layer-norm">Batch Norm vs Layer Norm</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#the-forward-pass">The Forward Pass</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#kernel-structure">Kernel Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#computing-the-mean">Computing the Mean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#computing-the-variance">Computing the Variance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#normalization-and-transformation">Normalization and Transformation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#the-backward-pass">The Backward Pass</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#gradient-mathematics">Gradient Mathematics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#gradient-for-biases">Gradient for Biases</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#gradient-for-weights">Gradient for Weights</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#gradient-for-input-complex">Gradient for Input (Complex!)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#parallel-reduction-strategy">Parallel Reduction Strategy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#the-challenge">The Challenge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#two-stage-reduction">Two-Stage Reduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#group-assignment">Group Assignment</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#using-locks">Using Locks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#in-kernel">In kernel:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#acquire-lock">Acquire lock</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#critical-section-update-dw-and-db">Critical section: Update DW and DB</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#release-lock">Release lock</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#lock-acquired-we-set-it-to-1">Lock acquired (we set it to 1)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#do-work">Do work…</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#triton-implementation-details">Triton Implementation Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#memory-layout">Memory Layout</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#stride-usage">Stride Usage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#why-use-float32-for-accumulation">Why Use float32 for Accumulation?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#performance-characteristics">Performance Characteristics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#computational-complexity">Computational Complexity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#memory-bandwidth">Memory Bandwidth</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#optimization-opportunities">Optimization Opportunities</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#common-pitfalls">Common Pitfalls</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#numerical-stability">1. Numerical Stability</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#dimension-confusion">2. Dimension Confusion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#gradient-accumulation-race-conditions">3. Gradient Accumulation Race Conditions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#use-locks-or-separate-buffers">Use locks or separate buffers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#advanced-concepts">Advanced Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#rmsnorm-simpler-variant">RMSNorm (Simpler Variant)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#groupnorm">GroupNorm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#fp8-and-mixed-precision">FP8 and Mixed Precision</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#comparison-to-pytorch">Comparison to PyTorch</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#pytorch-implementation">PyTorch Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#triton-advantages">Triton Advantages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#performance">Performance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/05-layer-norm.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html">Fused Attention (Flash Attention) in Triton</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#what-you-ll-learn">What You’ll Learn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#background-the-attention-mechanism">Background: The Attention Mechanism</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#standard-attention-formula">Standard Attention Formula</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#step-by-step-computation">Step-by-Step Computation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#the-memory-problem">The Memory Problem</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#flash-attention-the-key-insights">Flash Attention: The Key Insights</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#insight-1-we-don-t-need-to-store-s-and-p">Insight 1: We Don’t Need to Store S and P</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#insight-2-online-softmax">Insight 2: Online Softmax</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#pass-1-find-max">Pass 1: Find max</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#pass-2-compute-softmax">Pass 2: Compute softmax</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#the-online-softmax-algorithm">The Online Softmax Algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#standard-softmax">Standard Softmax</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#block-wise-computation">Block-wise Computation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#updating-the-output">Updating the Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#triton-implementation-details">Triton Implementation Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#the-inner-loop">The Inner Loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#causal-masking">Causal Masking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#stages-for-causal-attention">Stages for Causal Attention</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#memory-optimizations">Memory Optimizations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#tensor-descriptors">Tensor Descriptors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#warp-specialization">Warp Specialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#reduced-shared-memory">Reduced Shared Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#fp8-support">FP8 Support</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#backward-pass">Backward Pass</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#preprocess-step">Preprocess Step</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#computing-dk-and-dv">Computing dK and dV</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#computing-dq">Computing dQ</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#why-recomputation">Why Recomputation?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#performance-characteristics">Performance Characteristics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#memory-complexity">Memory Complexity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#compute-complexity">Compute Complexity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#arithmetic-intensity">Arithmetic Intensity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#auto-tuning-configurations">Auto-Tuning Configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#common-pitfalls">Common Pitfalls</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#sram-overflow">1. SRAM Overflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#numerical-instability">2. Numerical Instability</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#wrong">Wrong</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#right">Right</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#wrong-for-causal-token-can-t-attend-to-itself">Wrong for causal (token can’t attend to itself!)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#id9">Right</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#must-update-both-m-i-and-l-i">Must update both m_i and l_i!</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#and-correct-accumulator">And correct accumulator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#extensions-and-variants">Extensions and Variants</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#multi-query-attention-mqa">Multi-Query Attention (MQA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#grouped-query-attention-gqa">Grouped Query Attention (GQA)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#sliding-window-attention">Sliding Window Attention</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#flash-attention-3">Flash Attention 3</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#comparison-to-standard-attention">Comparison to Standard Attention</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/06-fused-attention.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html">Using External Functions (libdevice) in Triton</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#what-you-ll-learn">What You’ll Learn</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#what-is-libdevice">What is libdevice?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#nvidia-s-libdevice">NVIDIA’s libdevice</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#amd-s-device-libraries">AMD’s Device Libraries</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#what-functions-are-available">What Functions Are Available?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#why-use-external-functions">Why Use External Functions?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#triton-built-in-math">Triton Built-in Math</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#when-you-need-more">When You Need More</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#using-libdevice-in-triton">Using libdevice in Triton</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#the-simple-way-default-path">The Simple Way (Default Path)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#the-custom-path-way">The Custom Path Way</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#find-libdevice-in-triton-installation">Find libdevice in Triton installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#pass-to-kernel">Pass to kernel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#how-it-works-under-the-hood">How It Works Under the Hood</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#compilation-process">Compilation Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#type-dispatch">Type Dispatch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#calling-convention">Calling Convention</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#available-libdevice-functions-in-triton">Available libdevice Functions in Triton</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#triton-s-libdevice-wrapper">Triton’s libdevice Wrapper</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#trigonometric">Trigonometric</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#hyperbolic">Hyperbolic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#exponential-logarithmic">Exponential/Logarithmic</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#special-functions">Special functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#and-many-more">And many more!</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#example-arc-sine-asin">Example: Arc Sine (asin)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#the-math">The Math</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#why-use-libdevice">Why Use libdevice?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#full-example">Full Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#test">Test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#should-match">Should match!</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#performance-considerations">Performance Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#libdevice-performance">Libdevice Performance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#when-to-use-vs-triton-intrinsics">When to Use vs Triton Intrinsics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#linking-multiple-libraries-amd-example">Linking Multiple Libraries (AMD Example)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#debugging-linking-issues">Debugging Linking Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#common-errors">Common Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#verifying-libraries">Verifying Libraries</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#nvidia">NVIDIA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#amd">AMD</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#advanced-usage">Advanced Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#calling-custom-external-functions">Calling Custom External Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#id5">}</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#mixing-multiple-external-libraries">Mixing Multiple External Libraries</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#portability-considerations">Portability Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#nvidia-vs-amd">NVIDIA vs AMD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#function-name-differences">Function Name Differences</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#comparison-to-cuda">Comparison to CUDA</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#in-cuda">In CUDA</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#id6">}</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#in-triton">In Triton</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/07-extern-functions.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html">Tutorial 08: Grouped GEMM</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#key-concepts">Key Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#static-on-device-scheduling">Static On-Device Scheduling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#group-problem-representation">Group Problem Representation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#code-walkthrough">Code Walkthrough</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#grouped-gemm-kernel-basic-version">1. Grouped GEMM Kernel (Basic Version)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#tma-tensor-memory-accelerator-version">2. TMA (Tensor Memory Accelerator) Version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#host-function-setup">3. Host Function Setup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#auto-tuning-configurations">Auto-tuning Configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#memory-layout-considerations">Memory Layout Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#pointer-indirection">Pointer Indirection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#leading-dimension-stride">Leading Dimension (Stride)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#for-row-major-matrix-a-m-k">For row-major matrix A[M, K]:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#element-at-i-j-is-at-base-ptr-i-lda-j">Element at (i, j) is at: base_ptr + i * lda + j</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#performance-characteristics">Performance Characteristics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#when-grouped-gemm-wins">When Grouped GEMM Wins</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#when-to-use-separate-kernels">When to Use Separate Kernels</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#benchmarking-results">Benchmarking Results</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#id1">)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#gpu-architecture-insights">GPU Architecture Insights</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#why-fixed-number-of-ctas">Why Fixed Number of CTAs?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#work-distribution">Work Distribution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#advanced-tma-descriptor-creation">Advanced: TMA Descriptor Creation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#load-a-block-starting-at-offs-am-offs-k">Load a block starting at (offs_am, offs_k)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#common-pitfalls">Common Pitfalls</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#forgetting-contiguity">1. Forgetting Contiguity</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#bad-b-might-not-be-contiguous-after-transpose">Bad: B might not be contiguous after transpose</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#good-ensure-contiguity">Good: Ensure contiguity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#wrong-assuming-contiguous">Wrong: Assuming contiguous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#correct-use-actual-stride">Correct: Use actual stride</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#fp8-requires-compute-capability-9-0">FP8 requires compute capability &gt;= 9.0</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#practical-example">Practical Example</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#define-different-problem-sizes">Define different problem sizes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#create-random-matrices">Create random matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#compute-all-gemms-in-one-kernel-launch">Compute all GEMMs in one kernel launch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#verify-against-pytorch">Verify against PyTorch</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/08-grouped-gemm.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html">Tutorial 09: Persistent Matmul</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#key-concepts">Key Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#persistent-kernel-pattern">Persistent Kernel Pattern</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#traditional-kernel-one-cta-per-tile">Traditional kernel: One CTA per tile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#persistent-kernel-num-sms-ctas-process-all-tiles">Persistent kernel: NUM_SMS CTAs process all tiles</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#code-walkthrough">Code Walkthrough</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#naive-matmul-baseline">1. Naive Matmul (Baseline)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#id1">)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#persistent-matmul">2. Persistent Matmul</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#id4">)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#tma-matmul">3. TMA Matmul</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#tma-persistent-with-epilogue-subtiling">4. TMA Persistent with Epilogue Subtiling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#proton-profiler-integration">Proton Profiler Integration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#start-profiling">Start profiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#run-benchmarks">Run benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#finalize-and-show-results">Finalize and show results</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#device-side-vs-host-side-descriptors">Device-side vs Host-side Descriptors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#host-side-tensordescriptor">Host-side (TensorDescriptor)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#created-on-cpu-passed-to-gpu">Created on CPU, passed to GPU</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#warp-specialization-details">Warp Specialization Details</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#how-it-works">How It Works</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#requirements">Requirements</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#on-hopper-software-pipelining">On Hopper: Software pipelining</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#on-blackwell-hardware-warp-specialization">On Blackwell: Hardware warp specialization</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#flattening-in-persistent-loops">Flattening in Persistent Loops</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#choose-based-on-gpu-generation">Choose based on GPU generation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#performance-comparison">Performance Comparison</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#expected-speedups-relative-to-naive">Expected speedups (relative to naive):</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#when-each-variant-wins">When Each Variant Wins</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#precision-support">Precision Support</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#fp16-float16">FP16 (Float16)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#fp8-float8">FP8 (Float8)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#auto-tuning-configuration">Auto-tuning Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#command-line-usage">Command-line Usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#fp16-matmul">FP16 matmul</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#fp8-matmul-requires-hopper">FP8 matmul (requires Hopper+)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#profile-specific-k-dimension">Profile specific K dimension</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#common-pitfalls">Common Pitfalls</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#wrong-b-matrix-layout-for-tma">1. Wrong B Matrix Layout for TMA</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#tma-expects-b-to-be-transposed">TMA expects B to be transposed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#bad-using-both-in-same-kernel">Bad: Using both in same kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#good-pick-one-approach">Good: Pick one approach</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/09-persistent-matmul.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html">Tutorial 10: Block Scaled Matrix Multiplication</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#key-concepts">Key Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#block-scaling-fundamentals">Block Scaling Fundamentals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#quantization-formats">Quantization Formats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#memory-savings">Memory Savings</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#scale-preshuffling-nvidia">Scale Preshuffling (NVIDIA)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#why-preshuffling">Why Preshuffling?</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#original-linear-layout-m-k-vec-size">Original linear layout: [M, K // VEC_SIZE]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#each-row-has-k-vec-size-scales">Each row has K // VEC_SIZE scales</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#preshuffled-layout-m-128-k-vec-size-4-32-4-4">Preshuffled layout: [M // 128, K // VEC_SIZE // 4, 32, 4, 4]</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#organized-for-128-element-blocks-along-m">Organized for 128-element blocks along M</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#load-in-5d-preshuffled-format">Load in 5D preshuffled format</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#reshape-to-5d">Reshape to 5D</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#transpose-to-logical-2d-layout">Transpose to logical 2D layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#now-ready-for-tl-dot-scaled">Now ready for tl.dot_scaled</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#scale-preshuffling-amd-cdna4">Scale Preshuffling (AMD CDNA4)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#mfma-scale-organization">MFMA Scale Organization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#thread-level-access-pattern">Thread-level Access Pattern</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#code-walkthrough">Code Walkthrough</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#nvidia-kernel-tma-based">1. NVIDIA Kernel (TMA-based)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#amd-cdna4-kernel">2. AMD CDNA4 Kernel</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#initialization-and-setup">Initialization and Setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#nvidia-version">NVIDIA Version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#amd-version">AMD Version</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#performance-characteristics">Performance Characteristics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#theoretical-speedup">Theoretical Speedup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#real-world-performance">Real-world Performance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#numerical-considerations">Numerical Considerations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#quantization-error">Quantization Error</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#fp16-range-65504-3-decimal-digits">FP16 range: ±65504, ~3 decimal digits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#fp8-e4m3-range-448-2-decimal-digits">FP8 (E4M3) range: ±448, ~2 decimal digits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#fp4-e2m1-range-6-1-decimal-digit">FP4 (E2M1) range: ±6, ~1 decimal digit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#without-scaling">Without scaling:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#with-scaling">With scaling:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#example">Example:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#x-135-2-135-127-2-8-256">x = 135 → 2^(135-127) = 2^8 = 256</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#x-127-2-0-1">x = 127 → 2^0 = 1</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#x-119-2-8-0-00390625">x = 119 → 2^(-8) = 0.00390625</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#usage-examples">Usage Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#command-line-benchmarking">Command-line Benchmarking</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#nvidia-fp4">NVIDIA FP4</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#nvidia-fp8">NVIDIA FP8</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#amd-mxfp4-automatic-detection">AMD MXFP4 (automatic detection)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#mixed-precision">Mixed precision</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#nvidia">NVIDIA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#amd-with-both-mfma-shapes">AMD with both MFMA shapes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#common-pitfalls">Common Pitfalls</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#unsupported-hardware">1. Unsupported Hardware</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#format-mismatch">2. Format Mismatch</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#bad-using-amd-kernel-with-nvidia-formats">Bad: Using AMD kernel with NVIDIA formats</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#scales-must-match-data-dimensions">Scales must match data dimensions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#after-packing-to-5d">After packing to 5D</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../gpu-tutorials/10-block-scaled-matmul.html#summary">Summary</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Triton Compiler &amp; Internals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../triton-compiler/01-overview.html">Triton Compiler Architecture Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/01-overview.html#what-is-triton">What is Triton?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/01-overview.html#key-features">Key Features</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/01-overview.html#compilation-pipeline-overview">Compilation Pipeline Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/01-overview.html#architecture-components">Architecture Components</a></li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/01-overview.html#compilation-stages-in-detail">Compilation Stages in Detail</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/01-overview.html#stage-1-python-ast-parsing">Stage 1: Python AST Parsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/01-overview.html#stage-2-code-generation-ttir">Stage 2: Code Generation (TTIR)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/01-overview.html#stage-3-triton-gpu-ir-ttgir">Stage 3: Triton GPU IR (TTGIR)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/01-overview.html#stage-4-llvm-ir">Stage 4: LLVM IR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/01-overview.html#stage-5-ptx-amdgcn">Stage 5: PTX / AMDGCN</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/01-overview.html#stage-6-binary-cubin-hsaco">Stage 6: Binary (CUBIN / HSACO)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/01-overview.html#key-design-decisions">Key Design Decisions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/01-overview.html#block-based-programming-model">Block-based Programming Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/01-overview.html#jit-compilation">JIT Compilation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/01-overview.html#mlir-infrastructure">MLIR Infrastructure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/01-overview.html#source-code-organization">Source Code Organization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/01-overview.html#python-components">Python Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/01-overview.html#c-components">C++ Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/01-overview.html#backend-components">Backend Components</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/01-overview.html#links-to-source-code">Links to Source Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/01-overview.html#next-steps">Next Steps</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html">The &#64;triton.jit Decorator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#how-the-decorator-works">How the Decorator Works</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#implementation">Implementation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#the-jitcallable-base-class">The JITCallable Base Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#source-code-extraction">Source Code Extraction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#ast-parsing">AST Parsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#cache-key-generation">Cache Key Generation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#dependencies-tracking">Dependencies Tracking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#tracking-global-variables">Tracking Global Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#handling-nested-function-calls">Handling Nested Function Calls</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#the-jitfunction-class">The JITFunction Class</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#initialization">Initialization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#kernel-call-handling">Kernel Call Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#argument-specialization">Argument Specialization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#compilation-triggering">Compilation Triggering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#kernel-metadata">Kernel Metadata</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#launch-metadata">Launch Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#attributes-and-hints">Attributes and Hints</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#constexpr-parameters">Constexpr Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/02-jit-decorator.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html">Compilation Pipeline: AST to GPU Binary</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#code-generation-python-ast-triton-ir">Code Generation: Python AST → Triton IR</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#codegenerator-class">CodeGenerator Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#ast-visitor-pattern">AST Visitor Pattern</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#triton-language-primitives">Triton Language Primitives</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#type-inference">Type Inference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#example-ttir-output">Example TTIR Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#mlir-lowering-ttir-ttgir-llir">MLIR Lowering: TTIR → TTGIR → LLIR</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#compilation-orchestration">Compilation Orchestration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#ttir-ttgir-transformation">TTIR → TTGIR Transformation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#ttgir-llvm-ir">TTGIR → LLVM IR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#backend-compilation">Backend Compilation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#llvm-ir-ptx">LLVM IR → PTX</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#ptx-cubin">PTX → CUBIN</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#caching-strategy">Caching Strategy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#cache-key-components">Cache Key Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#cache-directory-structure">Cache Directory Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#cache-lookup">Cache Lookup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#performance-timeline">Performance Timeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/03-compilation-pipeline.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html">Triton vs CUDA C++: Compilation Comparison</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#overview-two-paths-same-destination">Overview: Two Paths, Same Destination</a></li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#traditional-cuda-c-compilation">Traditional CUDA C++ Compilation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#the-nvcc-compiler">The NVCC Compiler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#nvcc-compilation-stages">NVCC Compilation Stages</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#ptx-assembly-output">PTX Assembly Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#triton-compilation-revisited">Triton Compilation Revisited</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#the-llvm-path">The LLVM Path</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#llvm-ir-stage">LLVM IR Stage</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#ptx-generated-by-triton">PTX Generated by Triton</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#convergence-point-ptx-and-cubin">Convergence Point: PTX and CUBIN</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#same-tools-same-artifacts">Same Tools, Same Artifacts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#key-differences">Key Differences</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#source-language">Source Language</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#compiler-stack">Compiler Stack</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#compilation-time">Compilation Time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#optimization-levels">Optimization Levels</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#interoperability">Interoperability</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#can-triton-and-cuda-c-work-together">Can Triton and CUDA C++ Work Together?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#why-triton-chose-this-path">Why Triton Chose This Path</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#advantages-of-llvm-backend">Advantages of LLVM Backend</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#why-not-use-nvcc">Why Not Use NVCC?</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#trade-offs">Trade-offs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#compilation-artifacts-comparison">Compilation Artifacts Comparison</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#file-types">File Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#example-directory-structures">Example Directory Structures</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#inspecting-compilation-artifacts">Inspecting Compilation Artifacts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#ptx-inspection">PTX Inspection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#cubin-inspection">CUBIN Inspection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#summary">Summary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#compilation-paths-compared">Compilation Paths Compared</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#key-takeaways">Key Takeaways</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/04-cuda-comparison.html#further-reading">Further Reading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html">MLIR: Core Concepts and Triton Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#what-is-mlir">What is MLIR?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#the-problem-mlir-solves">The Problem MLIR Solves</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#traditional-compiler-limitations">Traditional Compiler Limitations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#example-matrix-multiplication">Example: Matrix Multiplication</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#mlir-philosophy">MLIR Philosophy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#core-mlir-concepts">Core MLIR Concepts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#dialects">1. Dialects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#common-dialects">Common Dialects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#triton-s-custom-dialects">Triton’s Custom Dialects</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#operations">2. Operations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#operation-anatomy">Operation Anatomy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#ssa-form-static-single-assignment">SSA Form (Static Single Assignment)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#operation-examples">Operation Examples</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#regions-and-blocks">3. Regions and Blocks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#regions">Regions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#blocks">Blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#example-with-regions-and-blocks">Example with Regions and Blocks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#types">4. Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#built-in-types">Built-in Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#triton-custom-types">Triton Custom Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#type-conversion">Type Conversion</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#attributes">5. Attributes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#common-attribute-types">Common Attribute Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#triton-layout-attributes">Triton Layout Attributes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#passes">6. Passes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#pass-types">Pass Types</a></li>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#example-pass-pipeline">Example Pass Pipeline</a></li>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#triton-specific-passes">Triton-Specific Passes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#mlir-in-triton">MLIR in Triton</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#why-triton-uses-mlir">Why Triton Uses MLIR</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#triton-s-mlir-dialects">Triton’s MLIR Dialects</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#triton-dialect-tt">Triton Dialect (tt)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#tritongpu-dialect-ttg">TritonGPU Dialect (ttg)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#tritonnvidiagpu-dialect-ttng">TritonNvidiaGPU Dialect (ttng)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#example-lowering-through-dialects">Example: Lowering Through Dialects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#python-source">Python Source</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#stage-1-triton-ir-ttir">Stage 1: Triton IR (TTIR)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#stage-2-tritongpu-ir-ttgir">Stage 2: TritonGPU IR (TTGIR)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#stage-3-llvm-dialect">Stage 3: LLVM Dialect</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#stage-4-llvm-ir-actual">Stage 4: LLVM IR (Actual)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#mlir-tools-and-ecosystem">MLIR Tools and Ecosystem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#command-line-tools">Command-Line Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#tablegen-for-defining-operations">TableGen for Defining Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#debugging-mlir">Debugging MLIR</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#mlir-resources">MLIR Resources</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#official-documentation">Official Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#tutorials">Tutorials</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#triton-specific">Triton-Specific</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#summary">Summary</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#key-concepts-recap">Key Concepts Recap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#why-mlir-matters-for-triton">Why MLIR Matters for Triton</a></li>
<li class="toctree-l3"><a class="reference internal" href="../triton-compiler/05-mlir-concepts.html#the-big-picture">The Big Picture</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources &amp; Support</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../learning-paths.html">Learning Paths</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../learning-paths.html#path-1-fast-track-essentials">Path 1: Fast Track (Essentials)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learning-paths.html#path-2-deep-understanding-comprehensive">Path 2: Deep Understanding (Comprehensive)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learning-paths.html#path-3-transformer-focus-for-llm-nlp">Path 3: Transformer Focus (For LLM/NLP)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learning-paths.html#path-4-computer-vision-focus">Path 4: Computer Vision Focus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learning-paths.html#path-5-performance-engineering">Path 5: Performance Engineering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learning-paths.html#by-topic">By Topic</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../learning-paths.html#memory-optimization">Memory Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../learning-paths.html#compute-optimization">Compute Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../learning-paths.html#backward-pass-training">Backward Pass / Training</a></li>
<li class="toctree-l3"><a class="reference internal" href="../learning-paths.html#advanced-techniques">Advanced Techniques</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../learning-paths.html#learning-tips">Learning Tips</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learning-paths.html#assessment-checkpoints">Assessment Checkpoints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../learning-paths.html#after-path-1-fast-track">After Path 1 (Fast Track)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../learning-paths.html#after-path-2-comprehensive">After Path 2 (Comprehensive)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../learning-paths.html#after-path-3-transformer">After Path 3 (Transformer)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../learning-paths.html#next-steps-after-completing-a-path">Next Steps After Completing a Path</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learning-paths.html#resources-for-continued-learning">Resources for Continued Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../learning-paths.html#choose-your-path">Choose Your Path</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#out-of-memory-errors">Out of Memory Errors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#cuda-out-of-memory">CUDA Out of Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#out-of-shared-memory">Out of Shared Memory</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#correctness-issues">Correctness Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#wrong-results">Wrong Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#nan-or-inf-values">NaN or Inf Values</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#performance-issues">Performance Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#slower-than-pytorch">Slower Than PyTorch</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#low-gpu-utilization">Low GPU Utilization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#compilation-issues">Compilation Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#compilation-errors">Compilation Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#slow-compilation">Slow Compilation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#platform-specific-issues">Platform-Specific Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#nvidia-specific">NVIDIA-Specific</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#amd-specific">AMD-Specific</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#multi-gpu-issues">Multi-GPU Issues</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#wrong-gpu-selected">Wrong GPU Selected</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#debugging-techniques">Debugging Techniques</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#print-debugging">Print Debugging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#profiling">Profiling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#assertions">Assertions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#unit-testing">Unit Testing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#common-error-messages">Common Error Messages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#getting-help">Getting Help</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../troubleshooting.html#when-stuck">When Stuck</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#best-practices-for-avoiding-issues">Best Practices for Avoiding Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#prevention-checklist">Prevention Checklist</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshooting.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">References and Resources</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../references.html#official-documentation">Official Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references.html#triton">Triton</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references.html#cuda">CUDA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references.html#rocm-amd">ROCm (AMD)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references.html#pytorch">PyTorch</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#research-papers">Research Papers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references.html#flash-attention">Flash Attention</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references.html#normalization">Normalization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references.html#optimization-techniques">Optimization Techniques</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references.html#id1">Triton</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#books">Books</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references.html#gpu-programming">GPU Programming</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references.html#deep-learning">Deep Learning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#tools-and-profilers">Tools and Profilers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references.html#nvidia-tools">NVIDIA Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references.html#amd-tools">AMD Tools</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references.html#pytorch-profiler">PyTorch Profiler</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references.html#benchmarking">Benchmarking</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#online-resources">Online Resources</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references.html#tutorials-and-courses">Tutorials and Courses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references.html#community">Community</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references.html#blogs-and-articles">Blogs and Articles</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#example-repositories">Example Repositories</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references.html#triton-examples">Triton Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references.html#production-usage">Production Usage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#hardware-documentation">Hardware Documentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references.html#nvidia-gpus">NVIDIA GPUs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references.html#amd-gpus">AMD GPUs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#performance-databases">Performance Databases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#keeping-up-to-date">Keeping Up to Date</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../references.html#subscribe-to">Subscribe To</a></li>
<li class="toctree-l3"><a class="reference internal" href="../references.html#conferences">Conferences</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#academic-courses">Academic Courses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#contributing">Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#citation">Citation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../references.html#quick-reference">Quick Reference</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Triton GPU Programming Guide</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Queue Internal Mechanics: Condition Variables &amp; Events</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/cpu-concurrency/queue_internal_mechanics.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="queue-internal-mechanics-condition-variables-events">
<h1>Queue Internal Mechanics: Condition Variables &amp; Events<a class="headerlink" href="#queue-internal-mechanics-condition-variables-events" title="Link to this heading"></a></h1>
<section id="the-answer">
<h2>The Answer<a class="headerlink" href="#the-answer" title="Link to this heading"></a></h2>
<p><strong>No, the item itself doesn’t get a condition/event with it.</strong></p>
<p>Instead, the <strong>Queue object maintains condition variables</strong> that signal <strong>all waiting threads</strong> when items are added or removed.</p>
<p>—</p>
</section>
<section id="queue-s-internal-structure">
<h2>Queue’s Internal Structure<a class="headerlink" href="#queue-s-internal-structure" title="Link to this heading"></a></h2>
<p>When you create a Queue, here’s what’s inside:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>from queue import Queue</p>
<p>q = Queue()</p>
</section>
</section>
<section id="inside-the-queue-object">
<h1>Inside the Queue object:<a class="headerlink" href="#inside-the-queue-object" title="Link to this heading"></a></h1>
</section>
<section id="id1">
<h1>┌─────────────────────────────────────────┐<a class="headerlink" href="#id1" title="Link to this heading"></a></h1>
</section>
<section id="queue-internal-state">
<h1>│ Queue Internal State                    │<a class="headerlink" href="#queue-internal-state" title="Link to this heading"></a></h1>
</section>
<section id="id2">
<h1>├─────────────────────────────────────────┤<a class="headerlink" href="#id2" title="Link to this heading"></a></h1>
</section>
<section id="mutex-lock">
<h1>│ mutex: Lock()                           │<a class="headerlink" href="#mutex-lock" title="Link to this heading"></a></h1>
</section>
<section id="protects-all-modifications">
<h1>│   - Protects all modifications          │<a class="headerlink" href="#protects-all-modifications" title="Link to this heading"></a></h1>
</section>
<section id="id3">
<h1>│                                         │<a class="headerlink" href="#id3" title="Link to this heading"></a></h1>
</section>
<section id="not-empty-condition">
<h1>│ not_empty: Condition()                  │<a class="headerlink" href="#not-empty-condition" title="Link to this heading"></a></h1>
</section>
<section id="signals-when-items-added">
<h1>│   - Signals when items added            │<a class="headerlink" href="#signals-when-items-added" title="Link to this heading"></a></h1>
</section>
<section id="consumers-wait-on-this">
<h1>│   - Consumers wait on this              │<a class="headerlink" href="#consumers-wait-on-this" title="Link to this heading"></a></h1>
</section>
<section id="id4">
<h1>│                                         │<a class="headerlink" href="#id4" title="Link to this heading"></a></h1>
</section>
<section id="not-full-condition">
<h1>│ not_full: Condition()                   │<a class="headerlink" href="#not-full-condition" title="Link to this heading"></a></h1>
</section>
<section id="signals-when-items-removed">
<h1>│   - Signals when items removed          │<a class="headerlink" href="#signals-when-items-removed" title="Link to this heading"></a></h1>
</section>
<section id="producers-wait-on-this">
<h1>│   - Producers wait on this              │<a class="headerlink" href="#producers-wait-on-this" title="Link to this heading"></a></h1>
</section>
<section id="id5">
<h1>│                                         │<a class="headerlink" href="#id5" title="Link to this heading"></a></h1>
</section>
<section id="items">
<h1>│ items: []                               │<a class="headerlink" href="#items" title="Link to this heading"></a></h1>
</section>
<section id="actual-items-without-conditions">
<h1>│   - Actual items (without conditions)   │<a class="headerlink" href="#actual-items-without-conditions" title="Link to this heading"></a></h1>
</section>
<section id="id6">
<h1>│                                         │<a class="headerlink" href="#id6" title="Link to this heading"></a></h1>
</section>
<section id="task-counter-0">
<h1>│ task_counter: 0                         │<a class="headerlink" href="#task-counter-0" title="Link to this heading"></a></h1>
</section>
<section id="tracks-unfinished-tasks">
<h1>│   - Tracks unfinished tasks             │<a class="headerlink" href="#tracks-unfinished-tasks" title="Link to this heading"></a></h1>
</section>
<section id="id7">
<h1>└─────────────────────────────────────────┘<a class="headerlink" href="#id7" title="Link to this heading"></a></h1>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</section>
<section id="when-you-put-an-item">
<h1>When you put an item<a class="headerlink" href="#when-you-put-an-item" title="Link to this heading"></a></h1>
<p>q.put(42)</p>
</section>
<section id="inside-queue">
<h1>Inside queue:<a class="headerlink" href="#inside-queue" title="Link to this heading"></a></h1>
</section>
<section id="items-42-just-the-number-no-condition-attached">
<h1>items = [42]  ← Just the number, no condition attached<a class="headerlink" href="#items-42-just-the-number-no-condition-attached" title="Link to this heading"></a></h1>
</section>
<section id="not-empty-condition-wakes-up-consumers">
<h1>not_empty condition wakes up consumers<a class="headerlink" href="#not-empty-condition-wakes-up-consumers" title="Link to this heading"></a></h1>
</section>
<section id="not-full-condition-might-wake-up-producers">
<h1>not_full condition might wake up producers<a class="headerlink" href="#not-full-condition-might-wake-up-producers" title="Link to this heading"></a></h1>
<p>The <strong>item</strong> is just data. The <strong>conditions</strong> belong to the <strong>Queue</strong>, not the item.</p>
<p>—</p>
<section id="how-conditions-work-in-queue">
<h2>How Conditions Work in Queue<a class="headerlink" href="#how-conditions-work-in-queue" title="Link to this heading"></a></h2>
<section id="condition-variables-explained">
<h3>Condition Variables Explained<a class="headerlink" href="#condition-variables-explained" title="Link to this heading"></a></h3>
<p>A <strong>Condition variable</strong> is like a <strong>notification system</strong>:
- Threads can <strong>wait</strong> on a condition
- Threads can <strong>notify</strong> waiting threads</p>
<p>Condition Variable (not_empty):
┌────────────────────────────────┐
│ Waiting Threads Queue:         │
│ [Consumer1] [Consumer2] [C3]   │ ← Sleeping, waiting for items
└────────────────────────────────┘</p>
<blockquote>
<div><p>│
│ when put() is called
│ notify() is called
▼</p>
</div></blockquote>
<p>One waiting thread wakes up!</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span>
</pre></div>
</div>
</section>
</section>
<section id="put-what-actually-happens">
<h2>put() - What Actually Happens<a class="headerlink" href="#put-what-actually-happens" title="Link to this heading"></a></h2>
<section id="step-by-step-execution">
<h3>Step-by-Step Execution<a class="headerlink" href="#step-by-step-execution" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>q.put(item)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">**</span><span class="n">Internal</span> <span class="n">Queue</span> <span class="n">code</span><span class="p">:</span><span class="o">**</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<dl>
<dt>def put(self, item):</dt><dd><p># 1. Acquire the mutex (lock)
with self.mutex:</p>
<blockquote>
<div><p># 2. Wait if queue is full
while len(self.items) &gt;= self.maxsize:</p>
<blockquote>
<div><p>self.not_full.wait(self.mutex)
# Thread blocks here, waiting for space
# Releases mutex while waiting</p>
</div></blockquote>
<p># 3. Queue has space now, add item
self.items.append(item)
# items = [42]  ← Item added (no condition on item)</p>
<p># 4. Notify ONE consumer that item is available
self.not_empty.notify()
# Wakes one consumer waiting on not_empty</p>
</div></blockquote>
<p># 5. Mutex released here (with block ends)</p>
</dd>
</dl>
</section>
<section id="timeline-put-with-condition-variable">
<h3>Timeline: put() with Condition Variable<a class="headerlink" href="#timeline-put-with-condition-variable" title="Link to this heading"></a></h3>
<p>Time  Queue                    Condition Variables    Consumers
────────────────────────────────────────────────────────────────
0     put(42)                                         waiting…</p>
<blockquote>
<div><p>acquire mutex</p>
</div></blockquote>
<dl class="simple">
<dt>1                              not_empty signal       WAKE UP!</dt><dd><p>items.append(42)</p>
</dd>
</dl>
<p>2     notify()</p>
<dl class="simple">
<dt>3                                                     get() continues</dt><dd><p>release mutex</p>
</dd>
</dl>
<p>4     (done)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span>
</pre></div>
</div>
</section>
</section>
<section id="get-what-actually-happens">
<h2>get() - What Actually Happens<a class="headerlink" href="#get-what-actually-happens" title="Link to this heading"></a></h2>
<section id="id8">
<h3>Step-by-Step Execution<a class="headerlink" href="#id8" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>item = q.get()</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">**</span><span class="n">Internal</span> <span class="n">Queue</span> <span class="n">code</span><span class="p">:</span><span class="o">**</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<dl>
<dt>def get(self):</dt><dd><p># 1. Acquire the mutex (lock)
with self.mutex:</p>
<blockquote>
<div><p># 2. Wait if queue is empty
while len(self.items) == 0:</p>
<blockquote>
<div><p>self.not_empty.wait(self.mutex)
# Thread blocks here, waiting for items
# Releases mutex while waiting
# When notified, reacquires mutex and continues</p>
</div></blockquote>
<p># 3. Queue has items, remove one
item = self.items.pop(0)
# Just the value, no condition with it</p>
<p># 4. Notify ONE producer that space is available
self.not_full.notify()
# Wakes one producer waiting on not_full</p>
<p># 5. Return the item (just the value)
return item</p>
</div></blockquote>
<p># 6. Mutex released here (with block ends)</p>
</dd>
</dl>
</section>
<section id="timeline-get-with-condition-variable">
<h3>Timeline: get() with Condition Variable<a class="headerlink" href="#timeline-get-with-condition-variable" title="Link to this heading"></a></h3>
<p>Time  Queue                    Condition Variables    Producers
────────────────────────────────────────────────────────────────
0     get()                                           put() blocked</p>
<blockquote>
<div><p>acquire mutex                                   (queue full)</p>
</div></blockquote>
<dl class="simple">
<dt>1     items = [1,2,3]</dt><dd><p>items.pop(0) → returns 1  not_full signal       WAKE UP!</p>
</dd>
</dl>
<p>2     notify()</p>
<dl class="simple">
<dt>3     release mutex                                   put() continues</dt><dd><p>return 1</p>
</dd>
</dl>
<p>4     (done)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span>
</pre></div>
</div>
</section>
</section>
<section id="visual-no-condition-on-items">
<h2>Visual: No Condition On Items<a class="headerlink" href="#visual-no-condition-on-items" title="Link to this heading"></a></h2>
<p>Queue Structure:</p>
<p>┌──────────────────────────────────────────────────┐
│ Queue                                            │
│                                                  │
│  not_empty Condition Variable                   │
│  ┌─────────────────────────────────────────┐   │
│  │ Waiting Consumers: [C1] [C2] [C3]       │   │
│  │ (sleeping, blocked on not_empty.wait()) │   │
│  └─────────────────────────────────────────┘   │
│                                                  │
│  Items List (just data, no conditions):         │
│  ┌─────────────────────────────────────────┐   │
│  │ [42]  [7]  [199]  [88]                  │   │
│  │  ↑                                       │   │
│  │  └─ Just numbers, no events attached    │   │
│  └─────────────────────────────────────────┘   │
│                                                  │
│  not_full Condition Variable                    │
│  ┌─────────────────────────────────────────┐   │
│  │ Waiting Producers: [P1]                 │   │
│  │ (sleeping, blocked on not_full.wait())  │   │
│  └─────────────────────────────────────────┘   │
│                                                  │
└──────────────────────────────────────────────────┘</p>
<dl class="simple">
<dt>KEY: The conditions are properties of the QUEUE,</dt><dd><p>not attached to individual items!</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span>
</pre></div>
</div>
</section>
<section id="complete-put-and-get-timeline">
<h2>Complete put() and get() Timeline<a class="headerlink" href="#complete-put-and-get-timeline" title="Link to this heading"></a></h2>
<section id="scenario-queue-with-maxsize-2-multiple-producers-consumers">
<h3>Scenario: Queue with maxsize=2, multiple producers/consumers<a class="headerlink" href="#scenario-queue-with-maxsize-2-multiple-producers-consumers" title="Link to this heading"></a></h3>
<p>Initial:
Queue: []
not_empty: [Consumer1, Consumer2]  ← Waiting for items
not_full: []                       ← No one waiting</p>
<p>Time 0: Producer1.put(42)
├─ Acquire mutex
├─ Queue not full, add item
├─ items = [42]
├─ Call not_empty.notify()
│  └─ Consumer1 wakes up!
├─ Release mutex
└─ (put done)</p>
<p>Queue: [42]
not_empty: [Consumer2]  ← Consumer1 woke up
not_full: []</p>
<p>Time 1: Producer2.put(7)
├─ Acquire mutex
├─ Queue not full, add item
├─ items = [42, 7]
├─ Call not_empty.notify()
│  └─ Consumer2 wakes up!
├─ Release mutex
└─ (put done)</p>
<p>Queue: [42, 7]  ← FULL (maxsize=2)
not_empty: []   ← All consumers woke
not_full: []</p>
<p>Time 2: Producer3.put(199)
├─ Acquire mutex
├─ Queue IS FULL! len(items)=2 &gt;= maxsize=2
├─ Call not_full.wait(mutex)
│  └─ Producer3 BLOCKS here
│  └─ Releases mutex
└─ (waiting for space)</p>
<p>Queue: [42, 7]
not_empty: []
not_full: [Producer3]  ← Waiting for space</p>
<p>Time 3: Consumer1.get()
├─ Acquire mutex
├─ items = [42, 7], not empty
├─ item = items.pop(0) = 42  ← Returns just 42, no condition
├─ Call not_full.notify()
│  └─ Producer3 wakes up!
├─ Release mutex
└─ Return 42</p>
<p>Queue: [7]
not_empty: []
not_full: []  ← Producer3 woke up</p>
<p>Time 4: Producer3 continues from where it blocked
├─ Acquire mutex (had released it, now reacquires)
├─ Queue not full anymore, add item
├─ items = [7, 199]
├─ Call not_empty.notify() (no one waiting)
├─ Release mutex
└─ (put done)</p>
<p>Queue: [7, 199]  ← FULL again</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span>
</pre></div>
</div>
</section>
</section>
<section id="key-insight-conditions-are-on-queue-not-items">
<h2>Key Insight: Conditions Are On Queue, Not Items<a class="headerlink" href="#key-insight-conditions-are-on-queue-not-items" title="Link to this heading"></a></h2>
<section id="what-people-might-think-wrong">
<h3>What People Might Think (WRONG):<a class="headerlink" href="#what-people-might-think-wrong" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="wrong-mental-model">
<h1>❌ WRONG MENTAL MODEL<a class="headerlink" href="#wrong-mental-model" title="Link to this heading"></a></h1>
<p>q.put(42)  # Does the item 42 carry an event/condition with it?
item = q.get()  # Does the returned item have a condition?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</section>
<section id="correct-mental-model">
<h1>✓ CORRECT MENTAL MODEL<a class="headerlink" href="#correct-mental-model" title="Link to this heading"></a></h1>
<dl class="simple">
<dt>q.put(42)  # 42 goes into queue</dt><dd><p># Queue’s not_empty condition is signaled
# The number 42 itself has NO condition</p>
</dd>
<dt>item = q.get()  # 42 is returned as plain data</dt><dd><p># Queue’s not_full condition is signaled
# The number 42 returned has NO condition</p>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span>
</pre></div>
</div>
<section id="why-queue-uses-shared-conditions">
<h2>Why Queue Uses Shared Conditions<a class="headerlink" href="#why-queue-uses-shared-conditions" title="Link to this heading"></a></h2>
<section id="instead-of-per-item-events">
<h3>Instead of Per-Item Events<a class="headerlink" href="#instead-of-per-item-events" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="this-would-be-inefficient-if-items-had-events">
<h1>❌ This would be inefficient (if items had events)<a class="headerlink" href="#this-would-be-inefficient-if-items-had-events" title="Link to this heading"></a></h1>
<dl class="simple">
<dt>class BadQueue:</dt><dd><dl class="simple">
<dt>def put(self, item):</dt><dd><p>event = Event()
self.items.append((item, event))
# Every item carries its own event - wastes memory!</p>
</dd>
<dt>def get(self):</dt><dd><p>item, event = self.items.pop(0)
# What do we do with the event?
# Consumer doesn’t care about one item’s event
return item</p>
</dd>
</dl>
</dd>
</dl>
</section>
<section id="this-is-efficient-what-queue-actually-does">
<h1>✓ This is efficient (what Queue actually does)<a class="headerlink" href="#this-is-efficient-what-queue-actually-does" title="Link to this heading"></a></h1>
<dl class="simple">
<dt>class GoodQueue:</dt><dd><dl class="simple">
<dt>def <a href="#id9"><span class="problematic" id="id10">**</span></a>init**(self):</dt><dd><p>self.items = []
self.not_empty = Condition()  # Single condition for ALL items</p>
</dd>
<dt>def put(self, item):</dt><dd><p>self.items.append(item)  # Item is just data
self.not_empty.notify()  # Signal all waiting consumers</p>
</dd>
<dt>def get(self):</dt><dd><p>item = self.items.pop(0)  # Item is just data
return item</p>
</dd>
</dl>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span>
</pre></div>
</div>
<section id="how-conditions-work-the-mechanism">
<h2>How Conditions Work: The Mechanism<a class="headerlink" href="#how-conditions-work-the-mechanism" title="Link to this heading"></a></h2>
<section id="not-empty-notify-what-it-does">
<h3>not_empty.notify() - What It Does<a class="headerlink" href="#not-empty-notify-what-it-does" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="when-put-is-called">
<h1>When put() is called<a class="headerlink" href="#when-put-is-called" title="Link to this heading"></a></h1>
<p>q.put(42)</p>
</section>
<section id="inside-put">
<h1>Inside put():<a class="headerlink" href="#inside-put" title="Link to this heading"></a></h1>
<p>self.not_empty.notify()</p>
</section>
<section id="this-tells-the-condition-variable">
<h1>This tells the condition variable:<a class="headerlink" href="#this-tells-the-condition-variable" title="Link to this heading"></a></h1>
</section>
<section id="someone-just-added-an-item">
<h1>“Someone just added an item”<a class="headerlink" href="#someone-just-added-an-item" title="Link to this heading"></a></h1>
<p>#
The condition variable wakes ONE waiting thread
===============================================
(the one sleeping on not_empty.wait())
======================================
#
That thread checks: “Is there data now?”
========================================
If yes, it continues
====================
If no, it goes back to sleep
============================</p>
<p>BEFORE put():
┌─────────────────────────┐
│ not_empty Condition     │
│ Waiting threads:        │
│ [Consumer1]             │ ← Sleeping, waiting for items
│ [Consumer2]             │
│ [Consumer3]             │
│ Items: []               │
└─────────────────────────┘</p>
<p>put(42) called:
│
├─ items.append(42)
│
├─ not_empty.notify()
│  └─ Sends signal!
│
└─ (mutex released)</p>
<p>AFTER notify():
┌─────────────────────────┐
│ not_empty Condition     │
│ Waiting threads:        │
│ [Consumer1] ← WOKEN UP! │
│ [Consumer2]             │
│ [Consumer3]             │
│ Items: [42]             │
└─────────────────────────┘</p>
<p>Consumer1 wakes up:
├─ Reacquires mutex
├─ Checks: is items not empty? YES!
├─ Proceeds to pop item
└─ (gets the 42)</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span>
</pre></div>
</div>
<section id="back-to-your-original-question">
<h2>Back to Your Original Question<a class="headerlink" href="#back-to-your-original-question" title="Link to this heading"></a></h2>
<section id="does-each-item-get-a-condition">
<h3>“Does each item get a condition?”<a class="headerlink" href="#does-each-item-get-a-condition" title="Link to this heading"></a></h3>
<p><strong>No.</strong> Here’s why:</p>
<ol class="arabic simple">
<li><p><strong>Items are just data</strong> - 42, “hello”, [1,2,3], etc.</p></li>
<li><p><strong>Queue has conditions</strong> - not_empty, not_full</p></li>
<li><p><strong>Conditions signal all threads</strong> - not individual items</p></li>
<li><p><strong>More efficient</strong> - One pair of conditions for all items</p></li>
<li><p><strong>Correct semantics</strong> - Consumer doesn’t care which item, just needs one</p></li>
</ol>
</section>
<section id="the-flow">
<h3>The Flow<a class="headerlink" href="#the-flow" title="Link to this heading"></a></h3>
<dl>
<dt>put(42)</dt><dd><p>│
└─ Add 42 to items list
└─ Signal not_empty</p>
<blockquote>
<div><p>└─ Wakes one consumer</p>
</div></blockquote>
</dd>
<dt>get()</dt><dd><p>│
└─ Wait on not_empty (if empty)
└─ Remove 42 from items
└─ Return 42 (just the value, no condition)
└─ Signal not_full</p>
<blockquote>
<div><p>└─ Wakes one producer</p>
</div></blockquote>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span>
</pre></div>
</div>
</section>
</section>
<section id="real-code-example">
<h2>Real Code Example<a class="headerlink" href="#real-code-example" title="Link to this heading"></a></h2>
<section id="what-queue-put-actually-does">
<h3>What Queue.put() Actually Does<a class="headerlink" href="#what-queue-put-actually-does" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<p>from threading import Lock, Condition</p>
<dl>
<dt>class MyQueue:</dt><dd><dl>
<dt>def __init**(self, maxsize=0):</dt><dd><p>self.mutex = Lock()
self.not_empty = Condition(self.mutex)
self.not_full = Condition(self.mutex)
self.items = []
self.maxsize = maxsize
self.unfinished_tasks = 0</p>
</dd>
<dt>def put(self, item):</dt><dd><dl>
<dt>with self.not_full:  # Acquire lock via condition</dt><dd><p># Wait if full
while len(self.items) &gt;= self.maxsize and self.maxsize:</p>
<blockquote>
<div><p>self.not_full.wait()</p>
</div></blockquote>
<p># Add item (just the value, NO condition)
self.items.append(item)
self.unfinished_tasks += 1</p>
<p># Notify one consumer
self.not_empty.notify()</p>
</dd>
</dl>
</dd>
<dt>def get(self):</dt><dd><dl>
<dt>with self.not_empty:  # Acquire lock via condition</dt><dd><p># Wait if empty
while not self.items:</p>
<blockquote>
<div><p>self.not_empty.wait()</p>
</div></blockquote>
<p># Remove and return (just the value)
item = self.items.pop(0)</p>
<p># Notify one producer
self.not_full.notify()</p>
<p>return item</p>
</dd>
</dl>
</dd>
<dt>def task_done(self):</dt><dd><dl>
<dt>with self.mutex:</dt><dd><p>self.unfinished_tasks -= 1
if self.unfinished_tasks == 0:</p>
<blockquote>
<div><p># All tasks done, could notify here
pass</p>
</div></blockquote>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">---</span>
</pre></div>
</div>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading"></a></h2>
<div class="line-block">
<div class="line">Question | Answer |</div>
</div>
<p><a href="#id11"><span class="problematic" id="id12">|----------|</span></a>——–|
| <strong>Do items have conditions?</strong> | No, items are just data |
| <strong>Where are conditions?</strong> | In the Queue object itself |
| <strong>How many conditions?</strong> | Two: not_empty and not_full |
| <strong>What do conditions do?</strong> | Signal all waiting threads when state changes |
| <strong>Is condition per-item?</strong> | No, shared for all items |
| <strong>When does notification happen?</strong> | Every put() and get() |
| <strong>Who receives notification?</strong> | One waiting thread (if any) |</p>
<p>—</p>
</section>
<section id="key-takeaways">
<h2>Key Takeaways<a class="headerlink" href="#key-takeaways" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p><strong>Items are just data</strong> - No conditions attached</p></li>
<li><p><strong>Queue owns the conditions</strong> - not_empty and not_full</p></li>
<li><p><strong>Conditions are shared</strong> - Signal all consumers/producers</p></li>
<li><p><strong>Efficient design</strong> - One pair of conditions for unlimited items</p></li>
<li><p><strong>put() signals not_empty</strong> - “Item added, consumers can proceed”</p></li>
<li><p><strong>get() signals not_full</strong> - “Space freed, producers can proceed”</p></li>
<li><p><strong>Thread-safe</strong> - Mutex protects all modifications</p></li>
<li><p><strong>No per-item overhead</strong> - Conditions don’t travel with items</p></li>
</ol>
<p>The magic is that Queue uses <strong>shared conditions</strong> at the Queue level, not individual conditions per item. This is more efficient and achieves perfect synchronization!</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="queue_explained.html" class="btn btn-neutral float-left" title="Queue Explained: Thread-Safe Data Structure &amp; Locking" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="task_done_queue_explained.html" class="btn btn-neutral float-right" title="task_done() and Queue Explained: Counter &amp; Condition Variables" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Fast Concurrent Programs.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>